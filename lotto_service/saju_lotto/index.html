<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üçÄ ÏïºÏòπÏã† Î°úÎòê Î≤àÌò∏ Ï∂îÏ≤úÍ∏∞</title>

  <style>
    :root{
      /* LIGHT MODE COLORS */
      --bg1:#f6f2e7;
      --bg2:#efe7d6;
      --card:#ffffffcc;
      --stroke:rgba(24, 32, 48, .12);
      --shadow: 0 20px 60px rgba(15, 23, 42, 0.18);
      --text:#142033;
      --sub: rgba(20, 32, 51, .68);

      --mint:#b9ce89;
      --mint2:#5ca95b;
      --butter:#e8c572;
      --pink:#f7a3b0;

      --btn1:#22c55e;
      --btn2:#16a34a;
      
      --gold: #fbbf24;
      --silver: #94a3b8;
      --bronze: #b45309;

      --radius: 26px;
    }

    /* DARK MODE COLORS */
    body.dark-mode {
      --bg1: #1a0b14;   
      --bg2: #2d1b2e;   
      --card: rgba(45, 27, 46, 0.75);
      --stroke: rgba(255, 200, 200, 0.15);
      --shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
      --text: #eaddcf;  
      --sub: rgba(234, 221, 207, 0.6);

      --mint: #d946ef;  
      --mint2: #a21caf; 
      --butter: #f59e0b; 
      --pink: #be123c;   
      
      --btn1: #db2777; 
      --btn2: #9d174d;
      
      --gold: #f59e0b;
    }

    *{
      box-sizing:border-box;
    }
    html,body{
      height:100%;
    }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 15% 20%, rgba(92,169,91,.15), transparent 55%),
        radial-gradient(900px 500px at 85% 30%, rgba(232,197,114,.15), transparent 55%),
        radial-gradient(900px 500px at 50% 95%, rgba(247,163,176,.12), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    body.dark-mode {
        background:
        radial-gradient(1200px 600px at 20% 20%, rgba(162, 28, 175, 0.15), transparent 55%),
        radial-gradient(900px 500px at 80% 80%, rgba(190, 18, 60, 0.12), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }

    .bg-bubbles{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:0;
      opacity:.55;
    }
    .bubble{
      position:absolute;
      width: 180px;
      height: 180px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.7), rgba(255,255,255,.15));
      border: 1px solid rgba(255,255,255,.5);
      box-shadow: 0 18px 45px rgba(20,32,51,.08);
      animation: floaty 10s ease-in-out infinite;
    }
    body.dark-mode .bubble {
      background: radial-gradient(circle at 30% 30%, rgba(255, 100, 150, .15), rgba(100, 0, 50, .05));
      border: 1px solid rgba(255, 100, 150, .1);
      box-shadow: 0 18px 45px rgba(0,0,0,.4);
    }
    .bubble.b1{
      left:-40px;
      top:18%;
      width:220px;
      height:220px;
      animation-duration: 12s;
    }
    .bubble.b2{
      right:-60px;
      top:8%;
      width:260px;
      height:260px;
      animation-duration: 14s;
    }
    .bubble.b3{
      left:12%;
      bottom:-80px;
      width:240px;
      height:240px;
      animation-duration: 16s;
    }
    .bubble.b4{
      right:18%;
      bottom:-120px;
      width:300px;
      height:300px;
      animation-duration: 18s;
    }
    @keyframes floaty{
      0%,100%{
        transform: translateY(0) translateX(0) scale(1);
      }
      50%{
        transform: translateY(-18px) translateX(12px) scale(1.02);
      }
    }

    .wrap{
      position:relative;
      z-index:1;
      width:min(1060px, 92vw);
      margin: clamp(18px, 4vw, 36px) auto;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 18px;
    }
    @media (max-width: 940px){
      .wrap{
        grid-template-columns: 1fr;
      }
    }

    .panel{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow:hidden;
      position:relative;
      transition: background 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .panel::before{
      content:"";
      position:absolute;
      inset:-40px;
      background:
        radial-gradient(240px 240px at 20% 20%, rgba(185,206,137,.35), transparent 62%),
        radial-gradient(220px 220px at 80% 10%, rgba(232,197,114,.26), transparent 60%),
        radial-gradient(220px 220px at 85% 85%, rgba(247,163,176,.22), transparent 62%);
      pointer-events:none;
      z-index:0;
      transition: opacity 0.3s;
    }
    body.dark-mode .panel::before {
       opacity: 0.3;
       background:
        radial-gradient(240px 240px at 20% 20%, rgba(219, 39, 119, .2), transparent 62%),
        radial-gradient(220px 220px at 80% 10%, rgba(147, 51, 234, .15), transparent 60%);
    }
    .panel > *{
      position:relative;
      z-index:1;
    }

    .left{
      padding: 22px 22px 18px;
    }

    .title-row{
      display: block;
      margin-bottom: 12px;
    }
    .title-row::after {
      content: "";
      display: table;
      clear: both;
    }

    h1{
      margin:0;
      font-size: clamp(20px, 2.2vw, 28px);
      letter-spacing: -0.5px;
      line-height:1.2;
      transition: color 0.3s;
      padding-top: 4px;
    }
    body.dark-mode h1 {
      text-shadow: 0 0 20px rgba(219, 39, 119, 0.5);
    }
    
    .subtitle{
      margin:8px 0 0;
      color:var(--sub);
      font-size: 14px;
      line-height:1.5;
      word-break: keep-all;
      clear: left;
    }
    .header-actions {
      float: right;
      display: flex;
      gap: 8px;
      margin-left: 12px;
      margin-bottom: 4px;
    }

    .badge{
      display:flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.75);
      box-shadow: 0 10px 22px rgba(20,32,51,.08);
      white-space:nowrap;
      user-select:none;
      transition: background 0.3s, box-shadow 0.3s;
    }
    body.dark-mode .badge {
      background: rgba(30, 20, 30, 0.6);
      box-shadow: 0 10px 22px rgba(0,0,0,.3);
      border-color: rgba(219, 39, 119, 0.3);
    }
    .dot{
      width:10px;
      height:10px;
      border-radius:999px;
      background: linear-gradient(135deg, var(--btn1), var(--btn2));
      box-shadow: 0 0 0 4px rgba(34,197,94,.18);
    }
    body.dark-mode .dot {
      box-shadow: 0 0 0 4px rgba(219, 39, 119, 0.2);
    }
    .badge span{
      font-size: 12px;
      color: var(--sub);
      font-weight:900;
    }

    .theme-btn {
        width: 38px;
        height: 38px;
        border-radius: 50%;
        border: 1px solid var(--stroke);
        background: var(--card);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0;
        line-height: 1;
        font-size: 20px;
        transition: transform 0.2s, background 0.2s;
    }
    body.dark-mode .theme-btn {
      background: rgba(255,255,255,0.05);
      color: #fbbf24;
    }
    .theme-btn:hover {
      transform: scale(1.1);
    }
    .theme-btn:active {
      transform: scale(0.95);
    }

    /* FORM & INPUTS */
    .form{
      margin-top: 14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    @media (max-width: 520px){
      .form{
        grid-template-columns: 1fr;
      }
    }
    
    .field{
      background: rgba(255,255,255,.58);
      border: 1px solid var(--stroke);
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: 0 10px 22px rgba(20,32,51,.06);
    }
    body.dark-mode .field {
      background: rgba(10, 5, 10, 0.3);
      box-shadow: 0 10px 22px rgba(0,0,0,.2);
    }

    .field label{
      display:block;
      font-size: 12px;
      color: var(--sub);
      font-weight: 900;
      margin-bottom: 6px;
      letter-spacing:-0.2px;
    }
    .field input, .field select{
      width:100%;
      border:none;
      outline:none;
      background: transparent;
      font-size: 14px;
      color: var(--text);
      font-weight: 800;
      font-family:inherit;
    }
    .field select {
      cursor: pointer;
    }
    body.dark-mode input[type="date"] {
      color-scheme: dark;
    }
    body.dark-mode select {
      color: var(--text);
    }
    body.dark-mode select option {
      background: #1a0b14;
      color: #fff;
    }

    .field small{
      display:block;
      margin-top: 6px;
      font-size: 11px;
      color: var(--sub);
      opacity: 0.8;
      line-height:1.25;
    }

    .controls{
      margin-top: 12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    button{
      border:none;
      border-radius: 16px;
      padding: 12px 14px;
      cursor:pointer;
      font-weight: 950;
      transition: transform .12s ease, filter .14s ease, opacity .14s ease;
      user-select:none;
      display:flex;
      align-items:center;
      gap:10px;
      letter-spacing:-0.2px;
    }
    button:active{
      transform: translateY(1px) scale(.99);
    }
    button:hover{
      filter: brightness(1.02);
    }

    .btn-main{
      background: linear-gradient(135deg, var(--btn1), var(--btn2));
      color: #062012;
      box-shadow: 0 14px 28px rgba(22,163,74,.22);
      flex: 1;
      min-width: 230px;
      position:relative;
      overflow:hidden;
    }
    body.dark-mode .btn-main {
        background: linear-gradient(135deg, #be123c, #831843);
        color: #ffe4e6;
        box-shadow: 0 14px 28px rgba(190, 18, 60, 0.3);
    }
    .btn-main::after{
      content:"";
      position:absolute;
      inset:-40px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.45), transparent 40%);
      transform: translateX(-20%);
      opacity:.8;
      pointer-events:none;
    }
    
    .btn-ghost{
      background: rgba(255,255,255,.55);
      border: 1px solid var(--stroke);
      color: var(--text);
      box-shadow: 0 10px 22px rgba(20,32,51,.08);
    }
    body.dark-mode .btn-ghost {
      background: rgba(255,255,255,.05);
      box-shadow: 0 10px 22px rgba(0,0,0,.2);
    }
    
    .btn-icon{
      width: 34px;
      height: 34px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      background: rgba(255,255,255,.65);
      border:1px solid var(--stroke);
    }
    body.dark-mode .btn-icon {
      background: rgba(255,255,255,.1);
    }

    /*REPORT CARD */
    .report-card {
        margin-top: 18px;
        background: rgba(255,255,255,0.7);
        border: 1px solid var(--stroke);
        border-radius: 20px;
        padding: 16px;
        display: none;
        flex-direction: column;
        gap: 12px;
        animation: slideDown 0.4s ease-out;
    }
    body.dark-mode .report-card {
      background: rgba(0,0,0,0.3);
      border-color: var(--mint);
    }
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .report-header {
      font-size: 15px;
      font-weight: 900;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--stroke);
      padding-bottom: 8px;
    }
    .report-score {
      background: var(--btn1);
      color: #fff;
      padding: 4px 10px;
      border-radius: 99px;
      font-size: 12px;
      font-weight: 800;
    }
    .report-body {
      font-size: 13px;
      line-height: 1.5;
      color: var(--text);
    }
    .report-row {
      display: flex;
      gap: 8px;
      margin-bottom: 6px;
    }
    .report-label {
      flex: 0 0 55px;
      font-weight: 800;
      color: var(--sub);
    }
    .report-val {
      flex: 1;
      font-weight: 600;
    }
    
    .saju-desc {
        font-size: 13px;
        color: var(--text);
        margin-top: 6px;
        background: rgba(255,255,255,0.5);
        padding: 10px;
        border-radius: 12px;
        line-height: 1.5;
        border: 1px solid var(--stroke);
    }
    body.dark-mode .saju-desc {
      background: rgba(255,255,255,0.05);
      color: #e2e8f0;
    }
    
    .lucky-ball {
        display: inline-block;
        width: 20px;
        height: 20px;
        line-height: 20px;
        text-align: center;
        background: var(--mint);
        color: #fff;
        border-radius: 50%;
        font-size: 11px;
        margin-left: 4px;
        font-weight: bold;
    }
    
    .meta{
      margin-top: 12px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      color: var(--sub);
      font-size: 13px;
    }
    .toast{
      margin-top: 12px;
      min-height: 20px;
      font-size: 13px;
      color: var(--sub);
    }

    /* RIGHT PANEL */
    .right{
      display:flex;
      flex-direction:column;
    }
    .hero{
      padding: 18px 18px 0;
      display:flex;
      align-items:center;
      gap:14px;
    }
    .hero-img{
      width: 108px;
      height: 108px;
      border-radius: 26px;
      overflow:hidden;
      border: 1px solid var(--stroke);
      box-shadow: 0 16px 30px rgba(20,32,51,.14);
      flex: 0 0 auto;
      background: rgba(255,255,255,.65);
      position:relative;
    }
    body.dark-mode .hero-img {
      background: rgba(0,0,0,.2);
      box-shadow: 0 16px 30px rgba(0,0,0,.5);
      border-color: rgba(219, 39, 119, 0.3);
    }
    .hero-img img{
      width:100%;
      height:100%;
      object-fit:cover;
      transform: scale(1.08);
      filter: saturate(1.06) contrast(1.03);
      transition: opacity 0.3s ease;
    }
    .hero-text{
      flex:1;
      min-width:0;
    }
    .hero-text .big{
      font-weight: 1000;
      letter-spacing:-0.6px;
      font-size: 16px;
      margin:0 0 6px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .hero-text .small{
      margin:0;
      color: var(--sub);
      font-size: 13px;
      line-height:1.35;
      word-break: keep-all;
    }

    .result{
      padding: 14px 18px 18px;
      display:flex;
      flex-direction:column;
      gap: 12px;
    }
    .sort-area {
      display: none;
      justify-content: flex-end;
      gap: 8px;
    }
    .sets{
      display:grid;
      gap: 10px;
      transition: all 0.5s ease;
    }

    .set-card{
      background: rgba(255,255,255,.65);
      border: 1px solid var(--stroke);
      border-radius: 18px;
      padding: 12px 12px 10px;
      box-shadow: 0 10px 22px rgba(20,32,51,.08);
      overflow:visible;
      position:relative;
      transition: transform 0.3s ease, border-color 0.3s;
    }
    body.dark-mode .set-card {
      background: rgba(30, 20, 30, 0.4);
      box-shadow: 0 10px 22px rgba(0,0,0,.2);
    }
    .set-card::before{
      content:"";
      position:absolute;
      inset:-30px;
      background: radial-gradient(220px 160px at 10% 10%, rgba(185,206,137,.25), transparent 60%), radial-gradient(200px 140px at 80% 20%, rgba(232,197,114,.18), transparent 60%);
      pointer-events:none;
      border-radius: inherit;
    }
    body.dark-mode .set-card::before {
      opacity: 0.3;
      background: radial-gradient(220px 160px at 10% 10%, rgba(219, 39, 119, .2), transparent 60%);
    }

    /* Rank Styles - Badges */
    .rank-badge {
        position: absolute;
        top: -8px;
        right: -8px;
        padding: 4px 8px;
        border-radius: 8px;
        font-size: 11px;
        font-weight: 900;
        color: #fff;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        z-index: 5;
        display: none; 
        animation: popBadge 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .rank-score {
        display: block;
        font-size: 9px;
        opacity: 0.9;
        margin-top: 1px;
        font-weight: 400;
    }
    @keyframes popBadge {
      from {
        transform: scale(0);
      }
      to {
        transform: scale(1);
      }
    }

    .set-card.rank-1 {
      border: 2px solid var(--gold);
      transform: scale(1.02);
      z-index: 2;
    }
    .set-card.rank-1 .rank-badge {
      display: block;
      background: var(--gold);
    }
    
    .set-card.rank-2 {
      border: 1.5px solid var(--silver);
    }
    .set-card.rank-2 .rank-badge {
      display: block;
      background: var(--silver);
    }
    
    .set-card.rank-3 {
      border: 1.5px solid var(--bronze);
    }
    .set-card.rank-3 .rank-badge {
      display: block;
      background: var(--bronze);
    }

    .set-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      position:relative;
      z-index:1;
    }
    .set-label{
      font-weight: 1000;
      letter-spacing:-0.4px;
      font-size: 13px;
      color: var(--text);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .pill{
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.6);
      color: var(--sub);
      font-weight: 950;
    }
    body.dark-mode .pill {
      background: rgba(255,255,255,.1);
    }

    .mini-btn{
      padding: 8px 10px;
      border-radius: 14px;
      font-size: 12px;
      background: rgba(255,255,255,.7);
      border:1px solid var(--stroke);
      color: var(--text);
      box-shadow: 0 8px 14px rgba(20,32,51,.08);
      cursor:pointer;
      font-weight:950;
      display:flex;
      align-items:center;
      gap:8px;
      transition: transform .12s ease, opacity .12s ease;
      text-decoration: none;
    }
    body.dark-mode .mini-btn {
      background: rgba(255,255,255,.1);
      box-shadow: 0 8px 14px rgba(0,0,0,.2);
    }
    .mini-btn:active{
      transform: translateY(1px);
      opacity:.9;
    }

    .balls{
      margin-top: 10px;
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
      position:relative;
      z-index:1;
      min-height: 48px;
    }
    .ball{
      width: 44px;
      height: 44px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      font-weight: 1000;
      letter-spacing:-0.3px;
      color: rgba(11, 18, 32, .92);
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.22), 0 10px 18px rgba(15,23,42,.18);
      user-select:none;
      opacity: 0;
      transform: translateY(10px) scale(.92);
      will-change: transform, opacity, filter;
    }
    body.dark-mode .ball {
        box-shadow: inset 0 0 0 1px rgba(255,255,255,.3), 0 5px 15px rgba(0,0,0,.5);
        color: #fff;
        text-shadow: 0 1px 2px rgba(0,0,0,.5);
    }
    .ball.show{
      animation: pop .52s cubic-bezier(.2,.9,.2,1) both;
      animation-delay: var(--d, 0ms);
    }
    @keyframes pop{
      from {
        transform: translateY(10px) scale(.92);
        opacity: 0;
        filter: blur(2px);
      }
      to {
        transform: translateY(0) scale(1);
        opacity: 1;
        filter: blur(0);
      }
    }
    
    .ball.lucky {
      border: 2px solid #fff;
      box-shadow: 0 0 15px var(--mint2);
      z-index: 2;
      transform: scale(1.1);
    }
    body.dark-mode .ball.lucky {
      box-shadow: 0 0 15px #f472b6;
      border-color: #f472b6;
    }

    .r1{
      background: linear-gradient(135deg, #fbbf24, var(--butter));
    }
    .r2{
      background: linear-gradient(135deg, #93c5fd, #60a5fa);
    }
    .r3{
      background: linear-gradient(135deg, #fda4af, var(--pink));
    }
    .r4{
      background: linear-gradient(135deg, #86efac, #34d399);
    }
    .r5{
      background: linear-gradient(135deg, #c4b5fd, #a78bfa);
    }

    body.dark-mode .r1 {
      background: linear-gradient(135deg, #b45309, #d97706);
    } 
    body.dark-mode .r2 {
      background: linear-gradient(135deg, #1e3a8a, #2563eb);
    } 
    body.dark-mode .r3 {
      background: linear-gradient(135deg, #9f1239, #e11d48);
    } 
    body.dark-mode .r4 {
      background: linear-gradient(135deg, #14532d, #16a34a);
    } 
    body.dark-mode .r5 {
      background: linear-gradient(135deg, #581c87, #7c3aed);
    } 

    .spark{
      position:absolute;
      width:10px;
      height:10px;
      border-radius:999px;
      background: rgba(255,255,255,.9);
      pointer-events:none;
      box-shadow: 0 0 0 10px rgba(34,197,94,.12);
      animation: spark .6s ease-out forwards;
      z-index:9999;
    }
    body.dark-mode .spark {
      background: #f472b6;
      box-shadow: 0 0 0 10px rgba(219, 39, 119, .2);
    }
    @keyframes spark{
      from{
        transform: translate(0,0) scale(.9);
        opacity: .9;
      }
      to {
        transform: translate(var(--dx), var(--dy)) scale(0);
        opacity: 0;
      }
    }

    .loading{
      pointer-events:none;
      opacity:.92;
      filter:saturate(1.05);
    }
    .loading .btn-icon{
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    @media (prefers-reduced-motion: reduce) {
      .bubble{
        animation:none;
      }
      .ball.show{
        animation:none;
        opacity:1;
        transform:none;
        filter:none;
      }
      button{
        transition:none;
      }
      .loading .btn-icon{
        animation:none;
      }
    }

    /* ============================================
       ÎãπÏ≤®Ïûê Ïù∏Ï¶ù Î≥¥Îìú Ïä§ÌÉÄÏùº
       ============================================ */
    .winner-section {
      position: relative;
      z-index: 1;
      width: min(1060px, 92vw);
      margin: 0 auto clamp(18px, 4vw, 36px);
    }

    .winner-panel {
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      padding: 24px;
      position: relative;
      overflow: hidden;
    }
    .winner-panel::before {
      content: "";
      position: absolute;
      inset: -40px;
      background:
        radial-gradient(300px 300px at 10% 90%, rgba(251, 191, 36, .2), transparent 60%),
        radial-gradient(250px 250px at 90% 10%, rgba(247, 163, 176, .15), transparent 60%);
      pointer-events: none;
      z-index: 0;
    }
    body.dark-mode .winner-panel::before {
      opacity: 0.4;
      background:
        radial-gradient(300px 300px at 10% 90%, rgba(251, 191, 36, .15), transparent 60%),
        radial-gradient(250px 250px at 90% 10%, rgba(219, 39, 119, .1), transparent 60%);
    }
    .winner-panel > * {
      position: relative;
      z-index: 1;
    }

    .section-title {
      font-size: clamp(18px, 2vw, 24px);
      font-weight: 900;
      margin: 0 0 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Î™ÖÏòàÏùò Ï†ÑÎãπ */
    .hall-of-fame {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 12px;
      margin-bottom: 24px;
    }
    @media (max-width: 640px) {
      .hall-of-fame {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    @media (max-width: 420px) {
      .hall-of-fame {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .fame-card {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid var(--stroke);
      border-radius: 16px;
      padding: 16px 12px;
      text-align: center;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    body.dark-mode .fame-card {
      background: rgba(30, 20, 30, 0.5);
    }
    .fame-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.15);
    }
    .fame-card.gold { border-color: var(--gold); }
    .fame-card.silver { border-color: #94a3b8; }
    .fame-card.bronze { border-color: #b45309; }

    .fame-rank {
      font-size: 28px;
      margin-bottom: 4px;
    }
    .fame-label {
      font-size: 13px;
      font-weight: 800;
      color: var(--sub);
      margin-bottom: 8px;
    }
    .fame-count {
      font-size: 24px;
      font-weight: 1000;
      color: var(--text);
    }
    .fame-count span {
      font-size: 14px;
      font-weight: 600;
      color: var(--sub);
    }

    /* Ïù∏Ï¶ùÌïòÍ∏∞ Î≤ÑÌäº */
    .add-cert-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 100%;
      padding: 16px;
      border-radius: 16px;
      background: linear-gradient(135deg, var(--gold), #f59e0b);
      color: #1a1a1a;
      font-size: 16px;
      font-weight: 900;
      border: none;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(251, 191, 36, 0.3);
      transition: transform 0.2s, box-shadow 0.2s;
      margin-bottom: 24px;
    }
    body.dark-mode .add-cert-btn {
      background: linear-gradient(135deg, #be123c, #f43f5e);
      color: #fff;
      box-shadow: 0 10px 30px rgba(190, 18, 60, 0.3);
    }
    .add-cert-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 14px 36px rgba(251, 191, 36, 0.4);
    }
    body.dark-mode .add-cert-btn:hover {
      box-shadow: 0 14px 36px rgba(190, 18, 60, 0.4);
    }

    /* Ïù∏Ï¶ù ÌîºÎìú */
    .cert-feed {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
    }

    .cert-card {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--stroke);
      border-radius: 20px;
      overflow: hidden;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    body.dark-mode .cert-card {
      background: rgba(30, 20, 30, 0.6);
    }
    .cert-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 32px rgba(0,0,0,0.15);
    }

    .cert-image {
      width: 100%;
      aspect-ratio: 4/3;
      object-fit: cover;
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--sub);
      font-size: 48px;
    }
    .cert-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .cert-content {
      padding: 16px;
    }
    .cert-rank-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 99px;
      font-size: 12px;
      font-weight: 800;
      margin-bottom: 8px;
    }
    .cert-rank-badge.rank-1 { background: var(--gold); color: #1a1a1a; }
    .cert-rank-badge.rank-2 { background: #94a3b8; color: #1a1a1a; }
    .cert-rank-badge.rank-3 { background: #b45309; color: #fff; }
    .cert-rank-badge.rank-4 { background: #22c55e; color: #1a1a1a; }
    .cert-rank-badge.rank-5 { background: #60a5fa; color: #1a1a1a; }

    .cert-comment {
      font-size: 14px;
      line-height: 1.5;
      color: var(--text);
      margin-bottom: 8px;
    }
    .cert-date {
      font-size: 12px;
      color: var(--sub);
    }
    .cert-payment {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-top: 8px;
      padding: 4px 10px;
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(245, 158, 11, 0.1));
      border: 1px solid rgba(251, 191, 36, 0.3);
      border-radius: 99px;
      font-size: 11px;
      font-weight: 700;
      color: #b45309;
    }
    body.dark-mode .cert-payment {
      background: linear-gradient(135deg, rgba(244, 63, 94, 0.15), rgba(190, 18, 60, 0.1));
      border-color: rgba(244, 63, 94, 0.3);
      color: #fda4af;
    }

    .cert-prize {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 6px;
      padding: 6px 12px;
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.12), rgba(22, 163, 74, 0.08));
      border: 1px solid rgba(34, 197, 94, 0.25);
      border-radius: 10px;
      font-size: 13px;
      font-weight: 800;
      color: #16a34a;
    }
    body.dark-mode .cert-prize {
      background: linear-gradient(135deg, rgba(74, 222, 128, 0.12), rgba(34, 197, 94, 0.08));
      border-color: rgba(74, 222, 128, 0.25);
      color: #4ade80;
    }
    .cert-prize-amount {
      font-size: 15px;
    }

    .cert-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }
    .cert-meta-tag {
      padding: 3px 8px;
      background: rgba(0,0,0,0.05);
      border-radius: 6px;
      font-size: 11px;
      color: var(--sub);
    }
    body.dark-mode .cert-meta-tag {
      background: rgba(255,255,255,0.08);
    }

    /* Ïù∏Ï¶ù ÏÉÅÏÑ∏ Î™®Îã¨ */
    .detail-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .detail-modal-overlay.show {
      display: flex;
      animation: fadeIn 0.3s ease;
    }

    .detail-modal {
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: 0 40px 100px rgba(0,0,0,0.5);
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
    }
    body.dark-mode .detail-modal {
      background: #1a0b14;
    }

    .detail-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,0.9);
      cursor: pointer;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      transition: transform 0.2s;
    }
    body.dark-mode .detail-close {
      background: rgba(255,255,255,0.15);
    }
    .detail-close:hover {
      transform: scale(1.1);
    }

    .detail-image {
      width: 100%;
      max-height: 400px;
      object-fit: contain;
      background: #000;
    }

    .detail-body {
      padding: 24px;
    }
    .detail-rank-badge {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 900;
      margin-bottom: 12px;
    }
    .detail-rank-badge.rank-1 { background: var(--gold); color: #1a1a1a; }
    .detail-rank-badge.rank-2 { background: #94a3b8; color: #1a1a1a; }
    .detail-rank-badge.rank-3 { background: #b45309; color: #fff; }
    .detail-rank-badge.rank-4 { background: #22c55e; color: #1a1a1a; }
    .detail-rank-badge.rank-5 { background: #60a5fa; color: #1a1a1a; }

    .detail-prize {
      font-size: 28px;
      font-weight: 1000;
      color: #16a34a;
      margin: 16px 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    body.dark-mode .detail-prize {
      color: #4ade80;
    }

    .detail-info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin: 16px 0;
    }
    .detail-info-item {
      background: rgba(0,0,0,0.03);
      border-radius: 12px;
      padding: 12px;
    }
    body.dark-mode .detail-info-item {
      background: rgba(255,255,255,0.05);
    }
    .detail-info-label {
      font-size: 12px;
      color: var(--sub);
      margin-bottom: 4px;
    }
    .detail-info-value {
      font-size: 16px;
      font-weight: 800;
    }

    .detail-comment {
      font-size: 16px;
      line-height: 1.6;
      padding: 16px;
      background: rgba(0,0,0,0.03);
      border-radius: 12px;
      margin-top: 16px;
    }
    body.dark-mode .detail-comment {
      background: rgba(255,255,255,0.05);
    }

    .detail-payment-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 16px;
      padding: 8px 14px;
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.1));
      border: 1px solid rgba(251, 191, 36, 0.4);
      border-radius: 12px;
      font-size: 14px;
      font-weight: 700;
      color: #b45309;
    }
    body.dark-mode .detail-payment-badge {
      background: linear-gradient(135deg, rgba(244, 63, 94, 0.2), rgba(190, 18, 60, 0.1));
      border-color: rgba(244, 63, 94, 0.4);
      color: #fda4af;
    }

    /* Ï∂îÍ∞Ä ÏûÖÎ†• ÌïÑÎìú Ïä§ÌÉÄÏùº */
    .input-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 12px;
    }
    .input-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .input-group label {
      font-size: 12px;
      font-weight: 700;
      color: var(--sub);
    }
    .input-group input, .input-group select {
      padding: 10px 12px;
      border: 1px solid var(--stroke);
      border-radius: 10px;
      font-size: 14px;
      font-family: inherit;
      background: rgba(255,255,255,0.6);
      color: var(--text);
    }
    body.dark-mode .input-group input,
    body.dark-mode .input-group select {
      background: rgba(0,0,0,0.2);
    }
    .input-group input:focus, .input-group select:focus {
      outline: none;
      border-color: var(--mint2);
    }

    /* Ïª§Ïä§ÌÖÄ ÌöåÏ∞® ÎìúÎ°≠Îã§Ïö¥ */
    .round-dropdown {
      position: relative;
    }
    .round-selector {
      padding: 10px 12px;
      border: 1px solid var(--stroke);
      border-radius: 10px;
      font-size: 14px;
      font-family: inherit;
      background: rgba(255,255,255,0.6);
      color: var(--text);
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: border-color 0.2s;
    }
    body.dark-mode .round-selector {
      background: rgba(0,0,0,0.2);
    }
    .round-selector:hover {
      border-color: var(--mint2);
    }
    .round-selector .arrow {
      transition: transform 0.2s;
    }
    .round-selector.open .arrow {
      transform: rotate(180deg);
    }
    .round-list {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      max-height: 250px;
      overflow-y: auto;
      z-index: 100;
      display: none;
      margin-top: 4px;
    }
    body.dark-mode .round-list {
      background: #1a0b14;
    }
    .round-list.show {
      display: block;
      animation: slideDown 0.2s ease;
    }
    .round-item {
      padding: 10px 12px;
      cursor: pointer;
      font-size: 13px;
      border-bottom: 1px solid var(--stroke);
      transition: background 0.15s;
    }
    .round-item:last-child {
      border-bottom: none;
    }
    .round-item:hover {
      background: rgba(92, 169, 91, 0.1);
    }
    body.dark-mode .round-item:hover {
      background: rgba(219, 39, 119, 0.1);
    }
    .round-item.selected {
      background: rgba(92, 169, 91, 0.15);
      font-weight: 700;
    }
    body.dark-mode .round-item.selected {
      background: rgba(219, 39, 119, 0.15);
    }
    .round-item-main {
      font-weight: 700;
      color: var(--text);
    }
    .round-item-date {
      font-size: 11px;
      color: var(--sub);
      margin-left: 8px;
    }

    .prize-display {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(22, 163, 74, 0.05));
      border: 1px solid rgba(34, 197, 94, 0.2);
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 12px;
      text-align: center;
    }
    body.dark-mode .prize-display {
      background: linear-gradient(135deg, rgba(74, 222, 128, 0.1), rgba(34, 197, 94, 0.05));
    }
    .prize-display-label {
      font-size: 12px;
      color: var(--sub);
      margin-bottom: 4px;
    }
    .prize-display-amount {
      font-size: 20px;
      font-weight: 900;
      color: #16a34a;
    }
    body.dark-mode .prize-display-amount {
      color: #4ade80;
    }

    /* Í≤∞Ï†ú ÌôïÏù∏ Î™®Îã¨ */
    .payment-confirm-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(8px);
      z-index: 10001;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .payment-confirm-overlay.show {
      display: flex;
      animation: fadeIn 0.3s ease;
    }
    .payment-confirm-modal {
      background: var(--card);
      border-radius: var(--radius);
      padding: 32px;
      text-align: center;
      max-width: 400px;
      width: 100%;
    }
    body.dark-mode .payment-confirm-modal {
      background: #1a0b14;
    }
    .payment-confirm-icon {
      font-size: 64px;
      margin-bottom: 16px;
    }
    .payment-confirm-title {
      font-size: 20px;
      font-weight: 900;
      margin-bottom: 8px;
    }
    .payment-confirm-amount {
      font-size: 28px;
      font-weight: 1000;
      color: var(--gold);
      margin-bottom: 16px;
    }
    body.dark-mode .payment-confirm-amount {
      color: #f43f5e;
    }
    .payment-confirm-desc {
      font-size: 14px;
      color: var(--sub);
      margin-bottom: 24px;
      line-height: 1.5;
    }
    .payment-confirm-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
    }
    .payment-confirm-btn {
      padding: 14px 28px;
      border-radius: 14px;
      font-size: 15px;
      font-weight: 800;
      cursor: pointer;
      border: none;
      transition: transform 0.2s;
    }
    .payment-confirm-btn:hover {
      transform: translateY(-2px);
    }
    .payment-confirm-btn.primary {
      background: linear-gradient(135deg, var(--gold), #f59e0b);
      color: #1a1a1a;
    }
    body.dark-mode .payment-confirm-btn.primary {
      background: linear-gradient(135deg, #f43f5e, #be123c);
      color: #fff;
    }
    .payment-confirm-btn.secondary {
      background: rgba(0,0,0,0.05);
      color: var(--text);
    }
    body.dark-mode .payment-confirm-btn.secondary {
      background: rgba(255,255,255,0.1);
    }

    .cert-empty {
      grid-column: 1 / -1;
      text-align: center;
      padding: 48px 20px;
      color: var(--sub);
      font-size: 15px;
    }
    .cert-empty-icon {
      font-size: 48px;
      margin-bottom: 12px;
    }

    /* ============================================
       Ïù∏Ï¶ù Î™®Îã¨ Ïä§ÌÉÄÏùº
       ============================================ */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 9999;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .modal-overlay.show {
      display: flex;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: 0 30px 80px rgba(0,0,0,0.3);
      width: 100%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
    }
    body.dark-mode .modal-content {
      background: #1a0b14;
    }

    .modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,0.8);
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
      padding: 0;
      z-index: 10;
      transition: transform 0.2s;
    }
    body.dark-mode .modal-close {
      background: rgba(255,255,255,0.1);
    }
    .modal-close:hover {
      transform: scale(1.1);
    }

    .modal-header {
      padding: 24px 24px 0;
      text-align: center;
    }
    .modal-title {
      font-size: 22px;
      font-weight: 900;
      margin: 0;
    }

    .modal-body {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      padding: 24px;
    }
    @media (max-width: 640px) {
      .modal-body {
        grid-template-columns: 1fr;
      }
    }

    .modal-section {
      background: rgba(255,255,255,0.5);
      border: 1px solid var(--stroke);
      border-radius: 16px;
      padding: 20px;
    }
    body.dark-mode .modal-section {
      background: rgba(255,255,255,0.05);
    }

    .modal-section-title {
      font-size: 14px;
      font-weight: 800;
      color: var(--sub);
      margin: 0 0 12px;
    }

    .upload-area {
      border: 2px dashed var(--stroke);
      border-radius: 12px;
      padding: 32px 16px;
      text-align: center;
      cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
      margin-bottom: 16px;
    }
    .upload-area:hover {
      border-color: var(--mint2);
      background: rgba(92, 169, 91, 0.05);
    }
    body.dark-mode .upload-area:hover {
      border-color: var(--mint);
      background: rgba(219, 39, 119, 0.05);
    }
    .upload-area.has-image {
      padding: 8px;
    }
    .upload-area.has-image img {
      max-width: 100%;
      max-height: 200px;
      border-radius: 8px;
    }
    .upload-icon {
      font-size: 36px;
      margin-bottom: 8px;
    }
    .upload-text {
      font-size: 14px;
      color: var(--sub);
    }
    .upload-input {
      display: none;
    }

    .comment-input {
      width: 100%;
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: 12px;
      font-size: 14px;
      font-family: inherit;
      resize: none;
      background: rgba(255,255,255,0.6);
      color: var(--text);
    }
    body.dark-mode .comment-input {
      background: rgba(0,0,0,0.2);
    }
    .comment-input:focus {
      outline: none;
      border-color: var(--mint2);
    }
    body.dark-mode .comment-input:focus {
      border-color: var(--mint);
    }

    .rank-select {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--stroke);
      border-radius: 12px;
      font-size: 14px;
      font-family: inherit;
      background: rgba(255,255,255,0.6);
      color: var(--text);
      cursor: pointer;
      margin-bottom: 16px;
    }
    body.dark-mode .rank-select {
      background: rgba(0,0,0,0.2);
    }
    body.dark-mode .rank-select option {
      background: #1a0b14;
    }

    /* Î≥µÎπÑ Í≤∞Ï†ú ÏòÅÏó≠ */
    .payment-section {
      text-align: center;
      background: linear-gradient(180deg, rgba(251, 191, 36, 0.08), rgba(255, 255, 255, 0.5)) !important;
    }
    body.dark-mode .payment-section {
      background: linear-gradient(180deg, rgba(190, 18, 60, 0.15), rgba(30, 10, 20, 0.6)) !important;
    }
    .payment-mascot {
      width: 140px;
      height: 140px;
      margin: 0 auto 16px;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: 0 12px 32px rgba(251, 191, 36, 0.3);
      border: 3px solid rgba(251, 191, 36, 0.3);
    }
    body.dark-mode .payment-mascot {
      box-shadow: 0 12px 32px rgba(190, 18, 60, 0.4);
      border-color: rgba(244, 63, 94, 0.3);
    }
    .payment-mascot img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transform: scale(1.05);
    }
    .payment-desc {
      font-size: 13px;
      color: var(--sub);
      line-height: 1.5;
      margin-bottom: 16px;
    }
    .payment-options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-bottom: 12px;
    }
    .payment-option {
      padding: 10px 16px;
      border: 2px solid var(--stroke);
      border-radius: 12px;
      background: rgba(255,255,255,0.6);
      cursor: pointer;
      font-weight: 700;
      font-size: 14px;
      transition: border-color 0.2s, background 0.2s, transform 0.2s;
    }
    body.dark-mode .payment-option {
      background: rgba(255,255,255,0.05);
    }
    .payment-option:hover {
      border-color: var(--gold);
      transform: translateY(-2px);
    }
    body.dark-mode .payment-option:hover {
      border-color: #f43f5e;
    }
    .payment-option.selected {
      border-color: var(--gold);
      background: rgba(251, 191, 36, 0.2);
      box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3);
    }
    body.dark-mode .payment-option.selected {
      border-color: #f43f5e;
      background: rgba(244, 63, 94, 0.2);
      box-shadow: 0 4px 12px rgba(244, 63, 94, 0.3);
    }
    .payment-custom {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-bottom: 16px;
    }
    .payment-custom-input {
      width: 120px;
      padding: 10px 12px;
      border: 2px solid var(--stroke);
      border-radius: 12px;
      font-size: 14px;
      font-weight: 700;
      text-align: right;
      background: rgba(255,255,255,0.6);
      color: var(--text);
      font-family: inherit;
    }
    body.dark-mode .payment-custom-input {
      background: rgba(0,0,0,0.2);
    }
    .payment-custom-input:focus {
      outline: none;
      border-color: var(--gold);
    }
    body.dark-mode .payment-custom-input:focus {
      border-color: #f43f5e;
    }
    .payment-custom-label {
      font-size: 14px;
      color: var(--sub);
      font-weight: 600;
    }
    .payment-skip {
      font-size: 12px;
      color: var(--sub);
      text-decoration: underline;
      cursor: pointer;
      padding: 8px 16px;
      border-radius: 8px;
      transition: background 0.2s;
    }
    .payment-skip:hover {
      background: rgba(0,0,0,0.05);
      color: var(--text);
    }
    .payment-skip:hover {
      color: var(--text);
    }

    .modal-footer {
      padding: 0 24px 24px;
      text-align: center;
    }
    .submit-btn {
      padding: 16px 48px;
      border-radius: 16px;
      background: linear-gradient(135deg, var(--btn1), var(--btn2));
      color: #fff;
      font-size: 16px;
      font-weight: 900;
      border: none;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(34, 197, 94, 0.3);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    body.dark-mode .submit-btn {
      background: linear-gradient(135deg, #be123c, #831843);
      box-shadow: 0 10px 30px rgba(190, 18, 60, 0.3);
    }
    .submit-btn:hover {
      transform: translateY(-2px);
    }
    .submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
  </style>
</head>

<body>
  <div class="bg-bubbles" aria-hidden="true">
    <div class="bubble b1"></div>
    <div class="bubble b2"></div>
    <div class="bubble b3"></div>
    <div class="bubble b4"></div>
  </div>

  <main class="wrap">
    <!-- LEFT -->
    <section class="panel left">
      <div class="title-row">
        <div class="header-actions">
          <button class="theme-btn" id="btnTheme" title="Î™®Îìú Ï†ÑÌôò">üåô</button>
          <div class="badge" title="Ï£ºÏùò">
            <span class="dot"></span>
            <span id="txtBadge">Ïû¨ÎØ∏Ïö©Ïù¥ÎÉ•</span>
          </div>
        </div>

        <h1 id="txtTitle">üçÄ ÏïºÏòπÏã† Î°úÎòê Î≤àÌò∏ Ï∂îÏ≤ú</h1>
        <p class="subtitle" id="txtSub">
          Í∞ÑÎã® Ï†ïÎ≥¥ ÎÑ£ÏúºÎ©¥ Í∑∏ Í∏∞Ïö¥(?)ÏúºÎ°ú Î≤àÌò∏Î•º ÎΩëÏïÑÏ§ÄÎã§ÎÉ• üêæ<br/>
          ÎãπÏã†ÎßåÏùÑ ÏúÑÌïú Ïò§ÎäòÏùò ÌñâÏö¥ Î≤àÌò∏Î•º ÌôïÏù∏Ìï¥Î≥¥ÎùºÎÉ•!
        </p>
      </div>

      <!-- ÏÇ¨Ï£º ÎäêÎÇå ÏûÖÎ†• -->
      <div class="form">
        <div class="field">
          <label for="inpName">Ïù¥Î¶Ñ</label>
          <input id="inpName" type="text" placeholder="Ïòà) ÏïºÏòπÏù¥" autocomplete="name"/>
        </div>

        <div class="field">
          <label for="inpBirth">ÏÉùÎÖÑÏõîÏùº</label>
          <input id="inpBirth" type="date" />
        </div>

        <div class="field">
            <label for="inpTime">ÌÉúÏñ¥ÎÇú ÏãúÍ∞Ñ (ÏÑ†ÌÉù)</label>
            <select id="inpTime">
                <option value="">Î™®Î¶Ñ / Î¨¥Í¥Ä</option>
                <option value="23">ÏûêÏãú (23:30 ~ 01:29)</option>
                <option value="1">Ï∂ïÏãú (01:30 ~ 03:29)</option>
                <option value="3">Ïù∏Ïãú (03:30 ~ 05:29)</option>
                <option value="5">Î¨òÏãú (05:30 ~ 07:29)</option>
                <option value="7">ÏßÑÏãú (07:30 ~ 09:29)</option>
                <option value="9">ÏÇ¨Ïãú (09:30 ~ 11:29)</option>
                <option value="11">Ïò§Ïãú (11:30 ~ 13:29)</option>
                <option value="13">ÎØ∏Ïãú (13:30 ~ 15:29)</option>
                <option value="15">Ïã†Ïãú (15:30 ~ 17:29)</option>
                <option value="17">Ïú†Ïãú (17:30 ~ 19:29)</option>
                <option value="19">Ïà†Ïãú (19:30 ~ 21:29)</option>
                <option value="21">Ìï¥Ïãú (21:30 ~ 23:29)</option>
            </select>
        </div>

        <div class="field">
          <label for="inpKeyword">Ïò§ÎäòÏùò ÌÇ§ÏõåÎìú(ÏÑ†ÌÉù)</label>
          <input id="inpKeyword" type="text" placeholder="Ïòà) Í∏∞Î∂Ñ Ï¢ãÏùå / ÎåÄÎ∞ï" />
        </div>
      </div>

      <div class="controls">
        <button class="btn-main" id="btnPick">
          <span class="btn-icon">üé≤</span>
          <span id="txtBtnPick">ÏÇ¨Ï£º Í∏∞Ïö¥ÏúºÎ°ú Î≤àÌò∏ ÎΩëÍ∏∞</span>
        </button>

        <button class="btn-ghost" id="btnCopyAll" title="Ï†ÑÏ≤¥ Î≥µÏÇ¨">
          <span class="btn-icon">üìã</span>
          <span id="txtBtnCopy">Ï†ÑÏ≤¥ Î≥µÏÇ¨</span>
        </button>

        <button class="btn-ghost" id="btnReset" title="Ï¥àÍ∏∞Ìôî">
          <span class="btn-icon">üßº</span>
          <span id="txtBtnReset">Ï¥àÍ∏∞Ìôî</span>
        </button>
      </div>

      <!-- SAJU REPORT CARD -->
      <div class="report-card" id="reportCard">
        <div class="report-header">
           <span id="reportTitle">üîÆ Ïò§ÎäòÏùò Ïö¥ÏÑ∏ Î∂ÑÏÑù</span>
           <span class="report-score" id="reportScore">95Ï†ê</span>
        </div>
        <div class="report-body">
            <div class="report-row">
                <div class="report-label">ÏÇ¨Ï£º</div>
                <div class="report-val" id="reportSaju">...</div>
            </div>
            
            <div id="sajuEasyDesc" class="saju-desc"></div>

            <div class="report-row" style="margin-top:10px;">
                <div class="report-label">Ï¥ùÏö¥</div>
                <div class="report-val" id="reportTotal">...</div>
            </div>
            <div class="report-row">
                <div class="report-label">Í∏àÏ†ÑÏö¥</div>
                <div class="report-val" id="reportMoney">...</div>
            </div>
            <div class="report-row">
                <div class="report-label" style="color:var(--mint2)">ÌñâÏö¥Ïàò</div>
                <div class="report-val" id="reportLuckyMsg">
                    Ïò§ÎäòÏùò ÌñâÏö¥ Î≤àÌò∏ <span class="lucky-ball" id="reportLuckyNum">7</span>
                </div>
            </div>
        </div>
      </div>

      <div class="meta">
        <div id="seedInfo">Í∏∞Ïö¥: ÎåÄÍ∏∞Ï§ëÏù¥ÎÉ•</div>
        <div id="stamp">ÎåÄÍ∏∞ Ï§ë</div>
      </div>

      <div class="toast" id="toast">
        ÏïÑÏßÅ ÎΩëÏùÄ Î≤àÌò∏Í∞Ä ÏóÜÎã§ÎÉ•. Î≤ÑÌäº ÎàåÎü¨Î≥¥ÎùºÎÉ•!
      </div>

    </section>

    <!-- RIGHT -->
    <section class="panel right">
      <div class="hero">
        <div class="hero-img">
          <img id="mascot" alt="Ï∫êÎ¶≠ÌÑ∞" src="./mascot_bright.png" />
        </div>
        <div class="hero-text">
          <p class="big" id="txtHeroTitle">ÏïºÏòπÏã†Ïù¥ ÎΩëÏïÑÏ§Ä Î≤àÌò∏Îã§ÎÉ• üéÅ</p>
          <p class="small" id="txtHeroSub">ÏÑ∏Ìä∏Î≥Ñ <b>Î≥µÏÇ¨</b>ÎèÑ ÎêòÍ≥†, <b>Ï†ÑÏ≤¥ Î≥µÏÇ¨</b>ÎèÑ ÎêúÎã§ÎÉ•!</p>
        </div>
      </div>

      <div class="result">
        <div class="sort-area" id="sortArea">
            <button class="mini-btn" id="btnSort">
                üèÜ Í∏∞Ïö¥Ïàú Ï†ïÎ†¨ (TOP 5)
            </button>
            <a href="https://www.dhlottery.co.kr/" target="_blank" class="mini-btn" title="ÎèôÌñâÎ≥µÍ∂åÏúºÎ°ú Ïù¥Îèô">
                üõí Íµ¨Îß§ÌïòÎü¨ Í∞ÄÍ∏∞
            </a>
        </div>
        <div class="sets" id="sets"></div>
      </div>
    </section>
  </main>

  <!-- ÎãπÏ≤®Ïûê Ïù∏Ï¶ù Î≥¥Îìú ÏÑπÏÖò -->
  <section class="winner-section">
    <div class="winner-panel">
      <!-- Î™ÖÏòàÏùò Ï†ÑÎãπ -->
      <h2 class="section-title">üèÜ Î™ÖÏòàÏùò Ï†ÑÎãπ</h2>
      <div class="hall-of-fame" id="hallOfFame">
        <div class="fame-card gold">
          <div class="fame-rank">ü•á</div>
          <div class="fame-label">1Îì± ÎãπÏ≤®</div>
          <div class="fame-count" id="fame1">0<span>Î™Ö</span></div>
        </div>
        <div class="fame-card silver">
          <div class="fame-rank">ü•à</div>
          <div class="fame-label">2Îì± ÎãπÏ≤®</div>
          <div class="fame-count" id="fame2">0<span>Î™Ö</span></div>
        </div>
        <div class="fame-card bronze">
          <div class="fame-rank">ü•â</div>
          <div class="fame-label">3Îì± ÎãπÏ≤®</div>
          <div class="fame-count" id="fame3">0<span>Î™Ö</span></div>
        </div>
        <div class="fame-card">
          <div class="fame-rank">üéØ</div>
          <div class="fame-label">4Îì± ÎãπÏ≤®</div>
          <div class="fame-count" id="fame4">0<span>Î™Ö</span></div>
        </div>
        <div class="fame-card">
          <div class="fame-rank">üçÄ</div>
          <div class="fame-label">5Îì± ÎãπÏ≤®</div>
          <div class="fame-count" id="fame5">0<span>Î™Ö</span></div>
        </div>
      </div>

      <!-- Ïù∏Ï¶ùÌïòÍ∏∞ Î≤ÑÌäº -->
      <button class="add-cert-btn" id="btnAddCert">
        <span>üì∏</span>
        <span>ÎãπÏ≤® Ïù∏Ï¶ùÌïòÍ∏∞</span>
      </button>

      <!-- Ïù∏Ï¶ù ÌîºÎìú -->
      <h2 class="section-title">üì∑ ÎãπÏ≤® Ïù∏Ï¶ù ÌîºÎìú</h2>
      <div class="cert-feed" id="certFeed">
        <div class="cert-empty">
          <div class="cert-empty-icon">üé±</div>
          <p>ÏïÑÏßÅ Ïù∏Ï¶ùÎêú ÎãπÏ≤® ÎÇ¥Ïó≠Ïù¥ ÏóÜÎã§ÎÉ•!<br/>Ï≤´ Î≤àÏß∏ ÌñâÏö¥Ïùò Ï£ºÏù∏Í≥µÏù¥ ÎêòÏñ¥Î≥¥ÎùºÎÉ•~</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Ïù∏Ï¶ù Î™®Îã¨ -->
  <div class="modal-overlay" id="certModal">
    <div class="modal-content">
      <button class="modal-close" id="btnModalClose">‚úï</button>

      <div class="modal-header">
        <h3 class="modal-title">üéâ ÎãπÏ≤® Ïù∏Ï¶ùÌïòÍ∏∞</h3>
      </div>

      <div class="modal-body">
        <!-- Ï¢åÏ∏°: Ïù∏Ï¶ù Ï†ïÎ≥¥ ÏûÖÎ†• -->
        <div class="modal-section">
          <h4 class="modal-section-title">üì∏ ÎãπÏ≤® Ïù∏Ï¶ù</h4>

          <div class="input-row">
            <div class="input-group round-dropdown">
              <label>ÌöåÏ∞®</label>
              <div class="round-selector" id="roundSelector">
                <span id="roundSelectorText">ÌöåÏ∞® ÏÑ†ÌÉù</span>
                <span class="arrow">‚ñº</span>
              </div>
              <div class="round-list" id="roundList"></div>
              <input type="hidden" id="certRound" />
            </div>
            <div class="input-group">
              <label for="certCount">ÎãπÏ≤® Îß§Ïàò</label>
              <select id="certCount">
                <option value="1">1Ïû•</option>
                <option value="2">2Ïû•</option>
                <option value="3">3Ïû•</option>
                <option value="4">4Ïû•</option>
                <option value="5">5Ïû•</option>
                <option value="10">10Ïû•</option>
              </select>
            </div>
          </div>

          <div class="input-group" style="margin-bottom:12px;">
            <label for="certRank">ÎãπÏ≤® Îì±Ïàò</label>
            <select class="rank-select" id="certRank" style="margin-bottom:0;">
              <option value="1">ü•á 1Îì± (6Í∞ú Î≤àÌò∏ ÏùºÏπò)</option>
              <option value="2">ü•à 2Îì± (5Í∞ú + Î≥¥ÎÑàÏä§)</option>
              <option value="3">ü•â 3Îì± (5Í∞ú Î≤àÌò∏ ÏùºÏπò)</option>
              <option value="4">üéØ 4Îì± (4Í∞ú Î≤àÌò∏ ÏùºÏπò)</option>
              <option value="5">üçÄ 5Îì± (3Í∞ú Î≤àÌò∏ ÏùºÏπò)</option>
            </select>
          </div>

          <div class="input-group" id="prizeInputGroup" style="margin-bottom:12px;">
            <label for="certPrize">ÎãπÏ≤®Í∏à (ÏûêÎèô ÏûÖÎ†• / ÏàòÏ†ï Í∞ÄÎä•)</label>
            <input type="text" id="certPrize" placeholder="ÌöåÏ∞®Î≥Ñ ÏûêÎèô ÏûÖÎ†•Îê©ÎãàÎã§" />
          </div>

          <div class="prize-display" id="prizeDisplay">
            <div class="prize-display-label">ÏòàÏÉÅ Ï¥ù ÎãπÏ≤®Í∏à</div>
            <div class="prize-display-amount" id="totalPrizeDisplay">‚Ç©0</div>
          </div>

          <div class="upload-area" id="uploadArea">
            <div class="upload-icon">üì∑</div>
            <div class="upload-text">ÎãπÏ≤® Ï∫°Ï≤ò Ïù¥ÎØ∏ÏßÄÎ•º ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî<br/>(ÌÅ¥Î¶≠ / ÎìúÎûòÍ∑∏ / Ctrl+V Î∂ôÏó¨ÎÑ£Í∏∞)</div>
          </div>
          <input type="file" class="upload-input" id="certImage" accept="image/*" />

          <label for="certComment" class="modal-section-title">Ìïú Ï§Ñ ÏÜåÍ∞ê</label>
          <textarea class="comment-input" id="certComment" rows="3" placeholder="ÏïºÏòπÏã† ÎçïÎ∂ÑÏóê ÎãπÏ≤®ÎêêÎã§ÎÉ•! üéâ"></textarea>
        </div>

        <!-- Ïö∞Ï∏°: Î≥µÎπÑ Í≤∞Ï†ú (ÏÑ†ÌÉù) -->
        <div class="modal-section payment-section">
          <h4 class="modal-section-title" id="paymentTitle">üê± ÏïºÏòπÏã†ÏóêÍ≤å Î≥µÎπÑ ÎìúÎ¶¨Í∏∞</h4>
          <div class="payment-mascot">
            <img id="paymentMascot" src="./mascot_happy_bright.png" alt="ÌñâÎ≥µÌïú ÏïºÏòπÏã†" />
          </div>
          <p class="payment-desc">
            ÎãπÏ≤®Ïùò Í∏∞ÏÅ®ÏùÑ ÎÇòÎàÑÍ≥† Ïã∂Îã§Î©¥,<br/>
            Î≥µÎπÑÎ•º ÎìúÎ†§Î≥¥ÏÑ∏Ïöî!<br/>
            <small>(ÏÑ†ÌÉùÏÇ¨Ìï≠Ïù¥Î©∞, ÏóÜÏù¥ÎèÑ Ïù∏Ï¶ù Í∞ÄÎä•Ìï©ÎãàÎã§)</small>
          </p>

          <div class="payment-options" id="paymentOptions">
            <div class="payment-option" data-amount="1000">‚òï 1Ï≤úÏõê</div>
            <div class="payment-option" data-amount="5000">üç∞ 5Ï≤úÏõê</div>
            <div class="payment-option" data-amount="10000">üíù 1ÎßåÏõê</div>
            <div class="payment-option" data-amount="50000">üíé 5ÎßåÏõê</div>
            <div class="payment-option" data-amount="100000">üëë 10ÎßåÏõê</div>
            <div class="payment-option" data-amount="300000">üèÜ 30ÎßåÏõê</div>
          </div>

          <div class="payment-custom">
            <span class="payment-custom-label">ÏßÅÏ†ë ÏûÖÎ†•:</span>
            <input type="number" class="payment-custom-input" id="paymentCustom" placeholder="Í∏àÏï°" min="0" step="1000" />
            <span class="payment-custom-label">Ïõê</span>
          </div>

          <div class="payment-skip" id="btnSkipPayment">Î≥µÎπÑ ÏóÜÏù¥ Ïù∏Ï¶ùÌïòÍ∏∞</div>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="submit-btn" id="btnSubmitCert">üéä Ïù∏Ï¶ù Í≤åÏãúÌïòÍ∏∞</button>
      </div>
    </div>
  </div>

  <!-- Ïù∏Ï¶ù ÏÉÅÏÑ∏ Î≥¥Í∏∞ Î™®Îã¨ -->
  <div class="detail-modal-overlay" id="detailModal">
    <div class="detail-modal">
      <button class="detail-close" id="btnDetailClose">‚úï</button>
      <img class="detail-image" id="detailImage" src="" alt="ÎãπÏ≤® Ïù∏Ï¶ù Ïù¥ÎØ∏ÏßÄ" />
      <div class="detail-body">
        <span class="detail-rank-badge" id="detailRankBadge">ü•á 1Îì± ÎãπÏ≤®</span>
        <span class="cert-meta-tag" id="detailCount" style="margin-left:8px;">x1</span>

        <div class="detail-prize" id="detailPrize">
          <span>üí∞</span>
          <span id="detailPrizeAmount">‚Ç©0</span>
        </div>

        <div class="detail-info-grid">
          <div class="detail-info-item">
            <div class="detail-info-label">ÌöåÏ∞®</div>
            <div class="detail-info-value" id="detailRound">-</div>
          </div>
          <div class="detail-info-item">
            <div class="detail-info-label">Ïù∏Ï¶ùÏùº</div>
            <div class="detail-info-value" id="detailDate">-</div>
          </div>
        </div>

        <div class="detail-comment" id="detailComment">ÏÜåÍ∞êÏù¥ ÏóÜÏäµÎãàÎã§.</div>

        <div class="detail-payment-badge" id="detailPayment" style="display:none;">
          üíù <span id="detailPaymentAmount">Î≥µÎπÑ 0Ïõê</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Í≤∞Ï†ú ÌôïÏù∏ Î™®Îã¨ -->
  <div class="payment-confirm-overlay" id="paymentConfirmModal">
    <div class="payment-confirm-modal">
      <div class="payment-confirm-icon">üíù</div>
      <div class="payment-confirm-title" id="paymentConfirmTitle">ÏïºÏòπÏã†ÏóêÍ≤å Î≥µÎπÑ Î≥¥ÎÇ¥Í∏∞</div>
      <div class="payment-confirm-amount" id="paymentConfirmAmount">‚Ç©10,000</div>
      <div class="payment-confirm-desc">
        ÌõÑÏõê Î≤ÑÌäºÏùÑ ÎàÑÎ•¥Î©¥ ÌõÑÏõê ÌéòÏù¥ÏßÄÍ∞Ä Ïó¥Î¶ΩÎãàÎã§.<br/>
        Í∞úÏù∏Ï†ïÎ≥¥ ÎÖ∏Ï∂ú ÏóÜÏù¥ ÏïàÏ†ÑÌïòÍ≤å ÌõÑÏõêÌï† Ïàò ÏûàÏñ¥Ïöî!<br/>
        Ïù∏Ï¶ùÏùÄ Î®ºÏ†Ä Í≤åÏãúÎê©ÎãàÎã§ üôè
      </div>
      <div class="payment-confirm-buttons">
        <button type="button" class="payment-confirm-btn secondary" id="btnPaymentCancel">Ï∑®ÏÜå</button>
        <button type="button" class="payment-confirm-btn primary" id="btnPaymentProceed">‚òï ÌõÑÏõêÌïòÎü¨ Í∞ÄÍ∏∞</button>
      </div>
    </div>
  </div>

  <script>
    const setsEl  = document.getElementById("sets");
    const stampEl = document.getElementById("stamp");
    const toastEl = document.getElementById("toast");
    const seedInfoEl = document.getElementById("seedInfo");
    
    // Report Elements
    const reportCard = document.getElementById("reportCard");
    const reportTotal = document.getElementById("reportTotal");
    const reportMoney = document.getElementById("reportMoney");
    const reportScore = document.getElementById("reportScore");
    const reportLuckyNum = document.getElementById("reportLuckyNum");
    const reportLuckyMsg = document.getElementById("reportLuckyMsg");
    const reportTitle = document.getElementById("reportTitle");
    const reportSaju = document.getElementById("reportSaju");
    const sajuEasyDesc = document.getElementById("sajuEasyDesc");

    const btnPick    = document.getElementById("btnPick");
    const btnCopyAll = document.getElementById("btnCopyAll");
    const btnReset   = document.getElementById("btnReset");
    const btnTheme   = document.getElementById("btnTheme");
    const btnSort    = document.getElementById("btnSort");
    const sortArea   = document.getElementById("sortArea");

    const inpName    = document.getElementById("inpName");
    const inpBirth   = document.getElementById("inpBirth");
    const inpTime    = document.getElementById("inpTime");
    const inpKeyword = document.getElementById("inpKeyword");

    const txtTitle      = document.getElementById("txtTitle");
    const txtSub        = document.getElementById("txtSub");
    const txtBadge      = document.getElementById("txtBadge");
    
    const txtBtnPick    = document.getElementById("txtBtnPick");
    const txtBtnCopy    = document.getElementById("txtBtnCopy");
    const txtBtnReset   = document.getElementById("txtBtnReset");
    
    const txtHeroTitle  = document.getElementById("txtHeroTitle");
    const txtHeroSub    = document.getElementById("txtHeroSub");

    const mascotImg  = document.getElementById("mascot");

    const savedTheme = localStorage.getItem("theme");
    const systemDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
    let isDark = savedTheme === "dark" || (!savedTheme && systemDark);

    const TEXTS = {
      light: {
        title: "üçÄ ÏïºÏòπÏù¥ Î°úÎòê Î≤àÌò∏ Ï∂îÏ≤ú",
        sub: "Í∞ÑÎã® Ï†ïÎ≥¥ ÎÑ£ÏúºÎ©¥ Í∑∏ Í∏∞Ïö¥(?)ÏúºÎ°ú Î≤àÌò∏Î•º ÎΩëÏïÑÏ§ÄÎã§ÎÉ• üêæ<br/>ÎãπÏã†ÎßåÏùÑ ÏúÑÌïú Ïò§ÎäòÏùò ÌñâÏö¥ Î≤àÌò∏Î•º ÌôïÏù∏Ìï¥Î≥¥ÎùºÎÉ•!",
        badge: "Ïû¨ÎØ∏Ïö©Ïù¥ÎÉ•",
        bPick: "ÏÇ¨Ï£º Í∏∞Ïö¥ÏúºÎ°ú Î≤àÌò∏ ÎΩëÍ∏∞",
        bCopy: "Ï†ÑÏ≤¥ Î≥µÏÇ¨",
        bReset:"Ï¥àÍ∏∞Ìôî",
        heroT: "ÏïºÏòπÏù¥Í∞Ä ÎΩëÏïÑÏ§Ä Î≤àÌò∏Îã§ÎÉ• üéÅ",
        heroS: "ÏÑ∏Ìä∏Î≥Ñ <b>Î≥µÏÇ¨</b>ÎèÑ ÎêòÍ≥†, <b>Ï†ÑÏ≤¥ Î≥µÏÇ¨</b>ÎèÑ ÎêúÎã§ÎÉ•!",
        inpNamePh: "Ïòà) ÏïºÏòπÏù¥",
        inpKeyPh: "Ïòà) Í∏∞Î∂Ñ Ï¢ãÏùå / ÎåÄÎ∞ï",
        seedWait: "Í∏∞Ïö¥: ÎåÄÍ∏∞Ï§ëÏù¥ÎÉ•",
        toastInit: "ÏïÑÏßÅ ÎΩëÏùÄ Î≤àÌò∏Í∞Ä ÏóÜÎã§ÎÉ•. Î≤ÑÌäº ÎàåÎü¨Î≥¥ÎùºÎÉ•!",
        toastPick: "Î∂ÑÏÑù ÏôÑÎ£å! ÌñâÏö¥Ïùò Í∏∞Ïö¥ÏùÑ Îã¥ÏïÑ ÎΩëÏïòÎã§ÎÉ• üîÆ",
        toastRand: "Ï†ïÎ≥¥Í∞Ä ÏóÜÏñ¥ÏÑú ÏôÑÏ†Ñ ÎûúÎç§ÏúºÎ°ú ÎΩëÏïòÎã§ÎÉ• üé≤",
        toastCopy: "Ï†ÑÏ≤¥ Î≥µÏÇ¨ ÏôÑÎ£åÎã§ÎÉ• ‚úÖ",
        toastReset: "Ï¥àÍ∏∞ÌôîÌñàÎã§ÎÉ•. Îã§Ïãú ÎΩëÏïÑÎ≥¥ÎùºÎÉ• üé≤",
        repTitle: "üîÆ Ïò§ÎäòÏùò Ïö¥ÏÑ∏ Î∂ÑÏÑù",
        luckyMsgPre: "Ïò§ÎäòÏùò ÌñâÏö¥ Î≤àÌò∏Îäî ",
        luckyMsgPost: " Ïù¥Îã§ÎÉ•! Íº≠ Ï±ôÍ≤®Í∞ÄÎùºÎÉ•~"
      },
      dark: {
        title: "üç∑ Î™ΩÎßà ÏïºÏòπÏùò ÏùÄÎ∞ÄÌïú Ï†úÏïà",
        sub: "ÎÑàÏùò Ï†ïÎ≥¥Î•º ÏÇ¥Ïßù ÎÑòÍ∏∞Î©¥... ÏπòÎ™ÖÏ†ÅÏù∏ Î≤àÌò∏Î•º ÏÜçÏÇ≠Ïó¨Ï£ºÏßÄ üíã<br/>ÌîºÌï† Ïàò ÏóÜÎäî Ïö¥Î™ÖÏùò Î≤àÌò∏Î•º Î∞õÏïÑÎì§Ïó¨...",
        badge: "ÏòÅÌòº Í≥ÑÏïΩ üìú",
        bPick: "Í∏àÎã®Ïùò Î≤àÌò∏ ÏÜåÌôòÌïòÍ∏∞",
        bCopy: "Ï†ÑÎ∂Ä ÌõîÏπòÍ∏∞",
        bReset:"Í∏∞Ïñµ ÏÜåÍ±∞",
        heroT: "Ïûê, ÎÑ§Í∞Ä ÏõêÌïòÎçò ÏöïÎßù Îç©Ïñ¥Î¶¨Ïïº... üòà",
        heroS: "Í∞ÄÏ†∏Í∞Ä... ÌïòÏßÄÎßå <b>ÎãπÏ≤®</b>ÎêòÎ©¥ ÎÇòÎ•º ÏûäÏßÄ Îßà... üç∑",
        inpNamePh: "Ïòà) Í∏∏ ÏûÉÏùÄ Ïñ¥Î¶∞Ïñë",
        inpKeyPh: "Ïòà) Î∂ÄÍ∑ÄÏòÅÌôî / ÌÉÄÎùΩ",
        seedWait: "Í≥ÑÏïΩ: ÎåÄÍ∏∞ Ï§ë...",
        toastInit: "ÎßùÏÑ§Ïù¥ÏßÄ Îßà... Ïñ¥ÏÑú Í≥ÑÏïΩ(Î≤ÑÌäº)ÏùÑ ÏßÑÌñâÌï¥...",
        toastPick: "ÏπòÎ™ÖÏ†ÅÏù∏ Ïö¥Î™ÖÏùò Î≤àÌò∏Î•º ÏÜåÌôòÌñàÏñ¥... ü©∏",
        toastRand: "Í≤ÅÏüÅÏù¥Íµ∞... Î¨¥ÏûëÏúÑ Ïö¥Î™ÖÏóê ÎÑàÎ•º Îß°Í∏¥Îã§ üåë",
        toastCopy: "Ïù¥ Î≤àÌò∏Î•º ÌõîÏ≥êÍ∞ÄÎäîÍµ∞... Ï¢ãÏïÑ, ÎπÑÎ∞ÄÎ°ú Ìï¥Ï£ºÏßÄ.",
        toastReset: "Î™®Îì† Í∏∞ÏñµÏùÑ ÏßÄÏõ†Ïñ¥... Îã§Ïãú Ï≤òÏùåÎ∂ÄÌÑ∞ Ïú†ÌòπÌï¥Î¥ê.",
        repTitle: "ü©∏ Ïö¥Î™Ö Í≥ÑÏïΩÏÑú",
        luckyMsgPre: "Ïò§ÎäòÏùò ÌñâÏö¥ Î≤àÌò∏Îäî ",
        luckyMsgPost: "... Ïö¥Î™ÖÏùÑ Î∞îÍøÄ Ïó¥Ïá†Í∞Ä Îê† Í±∞Ïïº."
      }
    };

    function updateTheme() {
      const t = isDark ? TEXTS.dark : TEXTS.light;
      
      if (isDark) {
        document.body.classList.add("dark-mode");
        btnTheme.textContent = "‚òÄÔ∏è";
        mascotImg.src = "./mascot_dark.png";
      } else {
        document.body.classList.remove("dark-mode");
        btnTheme.textContent = "üåô";
        mascotImg.src = "./mascot_bright.png";
      }

      txtTitle.textContent = t.title;
      txtSub.innerHTML     = t.sub;
      txtBadge.textContent = t.badge;
      txtBtnPick.textContent    = t.bPick;
      txtBtnCopy.textContent    = t.bCopy;
      txtBtnReset.textContent   = t.bReset;
      txtHeroTitle.textContent  = t.heroT;
      txtHeroSub.innerHTML      = t.heroS;
      reportTitle.textContent   = t.repTitle;

      inpName.placeholder = t.inpNamePh;
      inpKeyword.placeholder = t.inpKeyPh;

      if (stampEl.textContent === "ÎåÄÍ∏∞ Ï§ë") {
        seedInfoEl.textContent = t.seedWait;
        toastEl.textContent = t.toastInit;
      }

      localStorage.setItem("theme", isDark ? "dark" : "light");
    }

    updateTheme();

    btnTheme.addEventListener("click", () => {
      isDark = !isDark;
      updateTheme();
      const rect = btnTheme.getBoundingClientRect();
      sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);
    });

    function setMascotFallback() {
      const bgColor = isDark ? "#1e293b" : "#fff7e6";
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="180" height="180" viewBox="0 0 180 180">
          <rect width="180" height="180" rx="34" fill="${bgColor}"/>
          <text x="50%" y="50%" font-size="24" text-anchor="middle" dy=".3em" fill="#888">
            ${isDark ? "Dark Img 404" : "Img 404"}
          </text>
        </svg>`;
      mascotImg.src = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg.trim());
    }
    mascotImg.addEventListener("error", setMascotFallback);

    // ============================================ 
    // üîÆ SajuEngine: Enhanced Fortune Logic
    // ============================================ 
    const SajuEngine = {
      GAN: ['Í∞ë','ÏùÑ','Î≥ë','Ï†ï','Î¨¥','Í∏∞','Í≤Ω','Ïã†','ÏûÑ','Í≥Ñ'],
      JI:  ['Ïûê','Ï∂ï','Ïù∏','Î¨ò','ÏßÑ','ÏÇ¨','Ïò§','ÎØ∏','Ïã†','Ïú†','Ïà†','Ìï¥'],
      
      DESC_GAN: {'Í∞ë':'ÌÅ∞ÎÇòÎ¨¥','ÏùÑ':'ÍΩÉ','Î≥ë':'ÌÉúÏñë','Ï†ï':'Ï¥õÎ∂à','Î¨¥':'ÌÅ∞ÏÇ∞','Í∏∞':'Î∞≠','Í≤Ω':'Î∞îÏúÑ','Ïã†':'Î≥¥ÏÑù','ÏûÑ':'Î∞îÎã§','Í≥Ñ':'ÎπóÎ¨º'},
      DESC_JI:  {'Ïûê':'Ï•ê','Ï∂ï':'ÏÜå','Ïù∏':'Ìò∏ÎûëÏù¥','Î¨ò':'ÌÜ†ÎÅº','ÏßÑ':'Ïö©','ÏÇ¨':'Î±Ä','Ïò§':'Îßê','ÎØ∏':'Ïñë','Ïã†':'ÏõêÏà≠Ïù¥','Ïú†':'Îã≠','Ïà†':'Í∞ú','Ìï¥':'ÎèºÏßÄ'},

      ELEMENTS: {
        'Í∞ë':'Î™©', 'ÏùÑ':'Î™©', 'Ïù∏':'Î™©', 'Î¨ò':'Î™©',
        'Î≥ë':'Ìôî', 'Ï†ï':'Ìôî', 'ÏÇ¨':'Ìôî', 'Ïò§':'Ìôî',
        'Î¨¥':'ÌÜ†', 'Í∏∞':'ÌÜ†', 'ÏßÑ':'ÌÜ†', 'Ïà†':'ÌÜ†', 'Ï∂ï':'ÌÜ†', 'ÎØ∏':'ÌÜ†',
        'Í≤Ω':'Í∏à', 'Ïã†':'Í∏à', 'Ïú†':'Í∏à',
        'ÏûÑ':'Ïàò', 'Í≥Ñ':'Ïàò', 'Ìï¥':'Ïàò', 'Ïûê':'Ïàò'
      },

      EASY_DESC: {
        'Î™©': {
             'Î™©': {L:'Ïö∏Ï∞ΩÌïú Ïà≤Ï≤òÎüº ÏπúÍµ¨Îì§Í≥º Ïñ¥Ïö∏Î¶¨Í∏∞ Ï¢ãÏùÄ ÎÇ†Ïù¥Îã§ÎÉ•! Ìï®ÍªòÌïòÎ©¥ ÌñâÏö¥Ïù¥ Îëê Î∞∞!', D:'Ïà≤Ïù¥ ÎÑàÎ¨¥ Ïö∞Í±∞Ï†∏ ÏïûÏù¥ Ïïà Î≥¥Ïùº Ïàò ÏûàÏñ¥. Í≥ÅÍ∞ÄÏßÄÎ•º Ï≥êÎÇ¥Í≥† ÎÑ§ Í∏∏ÏùÑ Í∞ÄÎùº.'},
             'Ìôî': {L:'ÎÇòÎ¨¥Í∞Ä Î∂àÏùÑ ÎßåÎÇò ÌôúÌôú ÌÉÄÏò§Î•∏Îã§ÎÉ•! ÎãπÏã†Ïùò Ïó¥Ï†ïÏùÑ ÎßòÍªè ÎΩêÎÇº Í∏∞Ìöå!', D:'ÏûêÏã†ÏùÑ ÌÉúÏõå ÎπõÏùÑ ÎÇ¥Îäî ÌòïÍµ≠... ÎÑàÎ¨¥ Î¨¥Î¶¨ÌïòÏßÄ ÎßàÎùº. Ïû¨Í∞Ä Îê† ÏàòÎèÑ ÏûàÎã§.'},
             'ÌÜ†': {L:'ÎÇòÎ¨¥Í∞Ä Îã®Îã®Ìïú ÌùôÏóê ÎøåÎ¶¨Î•º ÎÇ¥Î¶∞Îã§ÎÉ•! ÎÖ∏Î†•Ìïú ÎßåÌÅº Í≤∞Ïã§ÏùÑ Îß∫Îäî ÎÇ†!', D:'ÎøåÎ¶¨Í∞Ä ÎïÖÏùÑ ÌååÌó§ÏπòÎäîÍµ∞. ÎÇ®Ïùò Í≤ÉÏùÑ Ï∑®Ìï¥ÏÑúÎùºÎèÑ ÎÑ§ ÏûêÎ¶¨Î•º ÎßåÎì§Ïñ¥.'},
             'Í∏à': {L:'ÎèÑÎÅºÎ°ú ÎÇòÎ¨¥Î•º Îã§Îì¨Ïñ¥ Î©ãÏßÑ Í∞ÄÍµ¨Î•º ÎßåÎì†Îã§ÎÉ•! Ï°∞Í∏à ÌûòÎì§Ïñ¥ÎèÑ Í≤∞Í≥ºÎäî ÎåÄÎ∞ï!', D:'ÎÇ†Ïπ¥Î°úÏö¥ ÏπºÎÇ†Ïù¥ ÎÑàÎ•º ÎÖ∏Î¶∞Îã§. Î≤†Ïù¥ÏßÄ ÏïäÏúºÎ†§Î©¥ Ï†ïÏã† Î∞îÏßù Ï∞®Î†§Ïïº Ìï¥.'},
             'Ïàò': {L:'Î™©ÎßàÎ•∏ ÎÇòÎ¨¥Ïóê Îã®ÎπÑÍ∞Ä ÎÇ¥Î¶∞Îã§ÎÉ•! Í∑ÄÏù∏Ïùò ÎèÑÏõÄÏúºÎ°ú Ïë•Ïë• ÏÑ±Ïû•ÌïòÎäî ÎÇ†!', D:'Ï∞®Í∞ÄÏö¥ Î¨ºÏù¥ Ïä§Î©∞Îì†Îã§. ÍπäÏùÄ Ïπ®Î¨µ ÏÜçÏóêÏÑú ÏßÄÌòúÎ•º ÏñªÏùÑ ÎïåÏïº.'}
        },
        'Ìôî': {
             'Î™©': {L:'ÎïîÍ∞êÏùÑ ÏñªÏùÄ Î∂àÍΩÉÏ≤òÎüº Í∏∞Ïö¥Ïù¥ ÏÜüÏïÑÎÇúÎã§ÎÉ•! ÏúóÏÇ¨ÎûåÏùò ÎçïÏùÑ Î≥º Ïàò ÏûàÏñ¥.', D:'ÎàÑÍµ∞Í∞Ä Ïû•ÏûëÏùÑ ÎçòÏ†∏Ï£ºÎäîÍµ∞. Í∑∏ ÌûòÏùÑ Ïù¥Ïö©Ìï¥ Îçî Í±∞ÎåÄÌïòÍ≤å ÌÉÄÏò¨ÎùºÎùº.'},
             'Ìôî': {L:'Î∂àÍ≥º Î∂àÏù¥ ÎßåÎÇò ÌååÌã∞ Î∂ÑÏúÑÍ∏∞Îã§ÎÉ•! Ïò§ÎäòÏùÄ Ï¶êÍ≤ÅÍ≤å ÎÜÄÏïÑÎ≥¥Ïûê!', D:'ÌôîÎßàÍ∞Ä ÎçÆÏπòÎäî Í≤©Ïù¥Îã§. Î∂ÑÎÖ∏Î•º Ï°∞Ï†àÌïòÏßÄ Î™ªÌïòÎ©¥ Îã§Ïπ† Ïàò ÏûàÏñ¥.'},
             'ÌÜ†': {L:'Îî∞ÎúªÌïú Î∂àÏù¥ ÌùôÏùÑ Í∞êÏã∏Ï§ÄÎã§ÎÉ•. Î≤†Ìë∏Îäî ÎßåÌÅº Î≥µÏù¥ ÎèåÏïÑÏò§Îäî ÎÇ†!', D:'Î™®Îì† Í±∏ ÌÉúÏö∞Í≥† ÌùôÏúºÎ°ú ÎèåÏïÑÍ∞à ÌÖêÍ∞Ä? ÌóàÎ¨¥Ìï®ÏùÑ Í≤ΩÍ≥ÑÌï¥.'},
             'Í∏à': {L:'Î∂àÎ°ú Í∏àÏùÑ ÎÖπÏó¨ Î≥¥ÏÑùÏùÑ ÎßåÎì†Îã§ÎÉ•! ÎãπÏã†Ïùò Îä•Î†•ÏúºÎ°ú ÎèàÏùÑ Î≤ÑÎäî ÎÇ†!', D:'Ïá†Î•º ÎÖπÏù¥Îäî Í≥†ÌÜµÏùÑ Í≤¨ÎéåÎùº. Í∑∏ ÎÅùÏóî Îã¨ÏΩ§Ìïú Î≥¥ÏÉÅÏù¥ Í∏∞Îã§Î¶∞Îã§.'},
             'Ïàò': {L:'Î∂àÏù¥ ÎÑàÎ¨¥ Îú®Í±∞Ïö∏ Îïê Î¨ºÎ°ú ÏãùÌòÄÏïº ÌïúÎã§ÎÉ•. Ïû†Ïãú Ïâ¨Ïñ¥Í∞ÄÎäî ÏßÄÌòúÍ∞Ä ÌïÑÏöîÌï¥.', D:'Ï∞®Í∞ÄÏö¥ ÌòÑÏã§Ïù¥ ÎÑàÏùò Ïó¥Ï†ïÏùÑ Í∫ºÎú®Î¶¨Î†§ ÌïúÎã§. Î∂àÏî®Î•º ÏßÄÏºúÎÇ¥.'}
        },
        'ÌÜ†': {
             'Î™©': {L:'ÌùôÏóê ÎÇòÎ¨¥Î•º Ïã¨Îäî ÎÇ†! Ï±ÖÏûÑÍ∞êÏù¥ Î¨¥Í≤ÅÏßÄÎßå Î≥¥ÎûåÏ∞∞ Í±∞Ïïº.', D:'ÎàÑÍµ∞Í∞Ä ÎÑ§ ÏòÅÏó≠ÏùÑ Ïπ®Î≤îÌïòÎ†§ ÌïúÎã§. Î∫èÍ∏∞ÏßÄ ÏïäÍ≤å Í≤ΩÍ≥ÑÎ•º Îä¶Ï∂îÏßÄ Îßà.'},
             'Ìôî': {L:'Îî∞ÎúªÌïú ÌñáÏÇ¥ÏùÑ Î∞õÏùÄ ÌùôÏù¥Îã§ÎÉ•! ÏÇ¨ÎûëÍ≥º Ïù∏Ï†ïÏùÑ Îì¨Îøç Î∞õÎäî ÌïòÎ£®!', D:'Îú®Í±∞Ïö¥ Ïó¥Í∏∞Í∞Ä ÎïÖÏùÑ Î©îÎßàÎ•¥Í≤å ÌïúÎã§. Í∞àÏ¶ùÏùÑ Ìï¥ÏÜåÌï† Î∞©Î≤ïÏùÑ Ï∞æÏïÑ.'},
             'ÌÜ†': {L:'ÏÇ∞ ÎÑòÏñ¥ ÏÇ∞! Îì†Îì†Ìïú ÎèôÎ£åÏôÄ Ìï®ÍªòÎùºÎ©¥ ÎëêÎ†§Ïö∏ Í≤å ÏóÜÎã§ÎÉ•.', D:'Ï≤©Ï≤©ÏÇ∞Ï§ë... Í≥†ÏßëÏùÑ Î∂ÄÎ¶¨Î©¥ Í≥†Î¶ΩÎê† Ïàò ÏûàÏñ¥. Ïú†Ïó∞ÌïòÍ≤å ÎåÄÏ≤òÌï¥.'},
             'Í∏à': {L:'Ìùô ÏÜçÏóêÏÑú Í∏àÏùÑ Ï∫êÎÇ¥Îäî ÎÇ†! Ìö°Ïû¨ÏàòÍ∞Ä ÏûàÏúºÎãà Ï£ºÏúÑÎ•º Ïûò ÏÇ¥Ìé¥Î¥ê!', D:'ÎÑ§ ÏïàÏùò ÏöïÎßùÏùÑ Í∫ºÎÇ¥Îùº. Ïà®Í≤®ÏßÑ Î≥¥Î¨ºÏù¥ ÎπõÏùÑ Î≥º ÏãúÍ∞ÑÏù¥Îã§.'},
             'Ïàò': {L:'ÌùôÏúºÎ°ú ÌäºÌäºÌïú ÎåêÏùÑ ÎßåÎì†Îã§ÎÉ•! ÏÉàÏñ¥ÎÇòÍ∞ÄÎäî ÎèàÏùÑ ÍΩâ Ïû°ÏùÑ Ïàò ÏûàÏñ¥.', D:'ÌùêÎ•¥Îäî Î¨ºÏùÑ ÏñµÏßÄÎ°ú ÎßâÏúºÎ†§Îã§Í∞Ñ ÎëëÏù¥ ÌÑ∞Ïßà Ïàò ÏûàÏñ¥. Ï°∞Ïã¨Ìï¥.'}
        },
        'Í∏à': {
             'Î™©': {L:'ÎèÑÎÅºÎ°ú ÎÇòÎ¨¥Î•º Îã§Îì¨Ïñ¥ ÏÑ±Í≥ºÎ•º ÎÇ∏Îã§ÎÉ•! ÏùºÌïú ÎßåÌÅº ÌôïÏã§Ìïú Î≥¥ÏÉÅÏù¥!', D:'Í∞ÄÏ∞® ÏóÜÏù¥ ÏûòÎùºÎÇ¥Îùº. Í∞êÏ†ïÏóê ÌúòÎëòÎ¶¨Î©¥ Í∏∞ÌöåÎ•º ÎÜìÏπ† Í±∞Ïïº.'},
             'Ìôî': {L:'Î∂àÏóê Îã®Î†®ÎêòÎäî Í∞ïÏ≤†Ïù¥Îã§ÎÉ•! ÏãúÎ†®ÏùÑ Í≤™ÏùÑÏàòÎ°ù Îçî ÎπõÎÇòÎäî Î≤ï!', D:'Îú®Í±∞Ïö¥ Î∂àÍ∏∏ ÏÜçÏóê ÎçòÏ†∏Ï°åÎã§. ÎÖπÏïÑÎÇ¥Î¶¥ÏßÄ, Î™ÖÍ≤ÄÏù¥ Îê†ÏßÄÎäî ÎÑàÏóêÍ≤å Îã¨Î†∏Ïñ¥.'},
             'ÌÜ†': {L:'Í¥ëÏÇ∞ÏóêÏÑú Ï∫êÎÇ∏ Í∑ÄÌïú Î≥¥ÏÑùÏù¥Îã§ÎÉ•! Ïñ¥ÎîîÏÑúÎÇò Ï£ºÎ™©Î∞õÎäî Ïù∏Í∏∞ÏüÅÏù¥!', D:'Ïñ¥Îë† ÏÜçÏóêÏÑú ÏùÄÎ∞ÄÌïòÍ≤å ÎπõÎÇòÎäî Ï°¥Ïû¨Í∞ê... Ï°∞Ïö©Ìûà Ïã§ÏÜçÏùÑ Ï±ôÍ≤®.'},
             'Í∏à': {L:'Î≥¥ÏÑùÎÅºÎ¶¨ Î∂ÄÎî™ÌòÄ Ïß§ÎûëÍ±∞Î¶∞Îã§ÎÉ•! ÏπúÍµ¨Îì§Í≥º ÏàòÎã§ Îñ®Í∏∞ Ï¢ãÏùÄ ÎÇ†!', D:'ÎÇ†Ïπ¥Î°úÏö¥ ÏπºÍ≥º ÏπºÏùò ÎåÄÍ≤∞. ÌîºÎ•º Î≥¥ÏßÄ ÏïäÏúºÎ†§Î©¥ ÌïúÎ∞ú Î¨ºÎü¨ÏÑú.'},
             'Ïàò': {L:'ÎßëÏùÄ Î¨ºÏóê ÏîªÍ∏¥ Î≥¥ÏÑùÏ≤òÎüº Î∞òÏßùÏù∏Îã§ÎÉ•! ÎãπÏã†Ïùò Îß§Î†•Ïù¥ ÎèãÎ≥¥Ïù¥Îäî ÎÇ†!', D:'Ï∞®Í∞ëÍ≤å ÏãùÏùÄ ÏπºÎÇ†... ÎÉâÏ≤†Ìïú ÌåêÎã®ÎßåÏù¥ ÎÑàÎ•º Íµ¨ÏõêÌï† Í±∞Ïïº.'}
        },
        'Ïàò': {
             'Î™©': {L:'ÎÇòÎ¨¥Ïóê Î¨ºÏùÑ Ï£ºÎäî Î≥¥ÎûåÏ∞¨ ÌïòÎ£®Îã§ÎÉ•! Î≤†Ìë∏Îäî Í∏∞ÏÅ®ÏùÑ ÎäêÍª¥Î¥ê.', D:'ÎÑ§ Í∏∞Ïö¥Ïù¥ Ïâ¥ ÏÉà ÏóÜÏù¥ Îπ†Ï†∏ÎÇòÍ∞ÑÎã§. ÎÇ® Ï¢ãÏùÄ ÏùºÎßå ÏãúÌÇ§ÏßÄ Îßà.'},
             'Ìôî': {L:'Î¨ºÎ°ú Î∂àÏùÑ ÎÅÑÎäî Ìï¥Í≤∞ÏÇ¨Îã§ÎÉ•! Ïñ¥Î†§Ïö¥ Î¨∏Ï†úÎèÑ Ï≤ôÏ≤ô Ìï¥Í≤∞!', D:'Ìè≠Ï£ºÌïòÎäî ÏÉÅÌô©ÏùÑ Ï†úÏïïÌï¥Îùº. ÎÑàÎßåÏù¥ Ïù¥ ÎÇúÏû•ÌåêÏùÑ ÎÅùÎÇº Ïàò ÏûàÏñ¥.'},
             'ÌÜ†': {L:'Î¨ºÍ∏∏ÏùÑ ÎßâÎäî ÎåêÏùÑ ÎßåÎÇ¨Îã§ÎÉ•. ÎãµÎãµÌï¥ÎèÑ Ïû†Ïãú ÌùêÎ¶ÑÏùÑ Î©àÏ∂îÍ≥† ÏÉùÍ∞ÅÌï¥Î≥¥Ïûê.', D:'ÌùêÎ•¥ÏßÄ Î™ªÌïòÎ©¥ Ïç©Îäî Î≤ï. ÎßâÌûå Í≥≥ÏùÑ Îö´ÏùÑ Ïö∞ÌöåÎ°úÎ•º Ï∞æÏïÑÎÇ¥.'},
             'Í∏à': {L:'Î∞îÏúÑ ÌãàÏóêÏÑú ÏÜüÏïÑÎÇòÎäî ÎßëÏùÄ ÏÉòÎ¨º! ÏïÑÏù¥ÎîîÏñ¥Í∞Ä ÏΩ∏ÏΩ∏ ÏèüÏïÑÏßÑÎã§ÎÉ•!', D:'ÎÇ†Ïπ¥Î°úÏö¥ ÏßÄÏÑ±Ïù¥ ÎÑàÎ•º ÎèïÎäîÎã§. Ï∞®Í∞ëÍ≥† ÏòàÎ¶¨ÌïòÍ≤å Î∂ÑÏÑùÌï¥.'},
             'Ïàò': {L:'ÌÅ∞ Í∞ïÎ¨ºÏù¥ ÎêòÏñ¥ Î∞îÎã§Î°ú ÌùòÎü¨Í∞ÑÎã§ÎÉ•! Îçî ÎÑìÏùÄ ÏÑ∏ÏÉÅÏúºÎ°ú ÎÇòÏïÑÍ∞à Í∏∞Ìöå!', D:'Ïã¨Ïó∞ÏùÑ Îì§Ïó¨Îã§Î≥¥Îäî ÎÇ†... ÎÑà ÏûêÏã†Ïùò Ïñ¥Îë†ÏùÑ ÎßàÏ£ºÌïòÍ≥† Î∞õÏïÑÎì§Ïó¨.'}
        }
      },

      LUCKY_MAP: {
        'Î™©': [5, 10, 15, 20, 25, 30, 35, 40, 45],
        'Ìôî': [4, 9, 14, 19, 24, 29, 34, 39, 44],
        'ÌÜ†': [1, 6, 11, 16, 21, 26, 31, 36, 41],
        'Í∏à': [3, 8, 13, 18, 23, 28, 33, 38, 43],
        'Ïàò': [2, 7, 12, 17, 22, 27, 32, 37, 42]
      },

      getGanji(y, m, d) {
        let yearVal = y;
        if (m < 2 || (m === 2 && d < 4)) yearVal = y - 1;
        const yearIdx = (yearVal - 4) % 60;
        const yearGan = this.GAN[yearIdx % 10];
        const yearJi  = this.JI[yearIdx % 12];

        const dayGanIdx = (Math.floor((new Date(y, m-1, d) - new Date(1900, 0, 1)) / 86400000) + 0) % 10;
        const dayJiIdx  = (Math.floor((new Date(y, m-1, d) - new Date(1900, 0, 1)) / 86400000) + 10) % 12;
        
        const dGan = this.GAN[(dayGanIdx + 100000) % 10];
        const dJi  = this.JI[(dayJiIdx + 100000) % 12];
        const dElem = this.getElement(dGan);

        return {
          year: `${yearGan}${yearJi}`,
          dayGan: dGan,
          dayJi: dJi,
          dayElement: dElem,
          desc: `${dGan}(${this.DESC_GAN[dGan]}/${dElem})`
        };
      },
      
      getTimeElement(dayGan, hour) {
          if (!hour && hour !== 0) return null;
          const h = parseInt(hour);
          const ganIdxMap = {'Í∞ë':0, 'ÏùÑ':1, 'Î≥ë':2, 'Ï†ï':3, 'Î¨¥':4, 'Í∏∞':5, 'Í≤Ω':6, 'Ïã†':7, 'ÏûÑ':8, 'Í≥Ñ':9};
          const baseIdx = ganIdxMap[dayGan];
          const offset = (baseIdx % 5) * 2;
          
          let timeBranchIdx = 0;
          if (h >= 23 || h < 1) timeBranchIdx = 0;
          else timeBranchIdx = Math.floor((h - 1) / 2) + 1;
          
          const timeGanIdx = (offset + timeBranchIdx) % 10;
          const tGan = this.GAN[timeGanIdx];
          return this.getElement(tGan);
      },

      getElement(char) {
        if (char === 'Ïã†') return 'Í∏à'; 
        return this.ELEMENTS[char] || 'ÌÜ†';
      },

      analyze(myElem, todayElem, timeElem = null) {
        const relations = {
          'Î™©': { 'Î™©':'ÎπÑÍ≤¨', 'Ìôî':'ÏãùÏÉÅ', 'ÌÜ†':'Ïû¨ÏÑ±', 'Í∏à':'Í¥ÄÏÑ±', 'Ïàò':'Ïù∏ÏÑ±' },
          'Ìôî': { 'Î™©':'Ïù∏ÏÑ±', 'Ìôî':'ÎπÑÍ≤¨', 'ÌÜ†':'ÏãùÏÉÅ', 'Í∏à':'Ïû¨ÏÑ±', 'Ïàò':'Í¥ÄÏÑ±' },
          'ÌÜ†': { 'Î™©':'Í¥ÄÏÑ±', 'Ìôî':'Ïù∏ÏÑ±', 'ÌÜ†':'ÎπÑÍ≤¨', 'Í∏à':'ÏãùÏÉÅ', 'Ïàò':'Ïû¨ÏÑ±' },
          'Í∏à': { 'Î™©':'Ïû¨ÏÑ±', 'Ìôî':'Í¥ÄÏÑ±', 'ÌÜ†':'Ïù∏ÏÑ±', 'Í∏à':'ÎπÑÍ≤¨', 'Ïàò':'ÏãùÏÉÅ' },
          'Ïàò': { 'Î™©':'ÏãùÏÉÅ', 'Ìôî':'Ïû¨ÏÑ±', 'ÌÜ†':'Í¥ÄÏÑ±', 'Í∏à':'Ïù∏ÏÑ±', 'Ïàò':'ÎπÑÍ≤¨' }
        };

        const rel = relations[myElem][todayElem];
        let timeBonus = 0;
        if (timeElem) {
            const timeRel = relations[myElem][timeElem];
            if (timeRel === 'ÎπÑÍ≤¨' || timeRel === 'Ïù∏ÏÑ±') timeBonus = 5;
            else if (timeRel === 'Ïû¨ÏÑ±') timeBonus = 3;
        }

        const TEXT_DB = {
            'ÎπÑÍ≤¨': {
                score: 60,
                totalL: "ÏπúÍµ¨Îì§Í≥º Ïñ¥Ïö∏Î¶¨Í∏∞ Ï¢ãÏùÄ ÎÇ†! Í≤ΩÏüÅÎ≥¥Îã® ÌòëÎ†•Ïù¥ Ï¢ãÎã§ÎÉ•.",
                totalD: "ÎùºÏù¥Î≤åÏù¥ Îì±Ïû•ÌñàÍµ∞. Î∞üÍ≥† Ïò¨ÎùºÏÑ§ Ï§ÄÎπÑÎÇò Ìï¥.",
                moneyL: "ÎèàÏù¥ ÎÇòÍ∞ÄÍ∏∞ Ïâ¨Ïö∞Îãà ÏßÄÍ∞ë Ï°∞Ïã¨! ÎçîÏπòÌéòÏù¥ Ï∂îÏ≤ú.",
                moneyD: "ÏöïÏã¨ Î∂ÄÎ¶¨Îã§ Î∫èÍ∏∏ Ïàò ÏûàÎã§. ÎÇ¥ Í≤ÉÏùÄ ÎÇ¥Í∞Ä ÏßÄÏºú."
            },
            'ÏãùÏÉÅ': {
                score: 85,
                totalL: "ÏïÑÏù¥ÎîîÏñ¥Í∞Ä ÎøúÎøú! Î≠êÎì† ÏãúÏûëÌïòÍ∏∞ Îî± Ï¢ãÏùÄ ÎÇ†Ïù¥ÎÉ•!",
                totalD: "ÎÑ§ Ïû¨Îä•Ïù¥ ÎπõÏùÑ Î∞úÌïòÎäîÍµ∞... ÏÇ¨ÎûåÎì§ÏùÑ ÌôÄÎ†§Î¥ê.",
                moneyL: "Ïû¨Ï£º Î∂ÄÎ†§ÏÑú Îèà Î≤ÑÎäî ÎÇ†! Ïó¥Ïã¨Ìûà ÏõÄÏßÅÏó¨Î≥¥ÎùºÎÉ•.",
                moneyD: "ÎÑàÏùò Îß§Î†• ÏûêÏ≤¥Í∞Ä ÎèàÏù¥ ÎêúÎã§. ÌåêÏùÑ ÍπîÏïÑÏ£ºÏßÄ."
            },
            'Ïû¨ÏÑ±': {
                score: 95,
                totalL: "Í≤∞Í≥ºÎ¨ºÏù¥ ÌôïÏã§Ìïú ÎÇ†! ÎÖ∏Î†•Ìïú ÎßåÌÅº Î≥¥ÏÉÅ Î∞õÎäîÎã§ÎÉ•!",
                totalD: "Î™®Îì† Í≤ÉÏùÑ Í∞ÄÏßà Ïàò ÏûàÎäî ÎÇ†... ÏöïÎßùÏùÑ Ïà®Í∏∞ÏßÄ Îßà.",
                moneyL: "üí∞ Í∏àÏ†ÑÏö¥ ÏµúÏÉÅ! Î°úÎòê ÏÇ¨Îü¨ Í∞ÄÍ∏∞ Îî±Ïù¥Îã§ÎÉ•!",
                moneyD: "Îèà ÎÉÑÏÉàÍ∞Ä ÏßÑÎèôÌïòÎäîÍµ∞. Ïãπ Îã§ Í∏ÅÏñ¥Î™®ÏïÑ."
            },
            'Í¥ÄÏÑ±': {
                score: 45,
                totalL: "Ï°∞Í∏à Î∂ÄÎã¥Ïä§Îü¨Ïö¥ ÏùºÏù¥ ÏÉùÍ∏∏ÏàòÎèÑ... Ï∞®Î∂ÑÌïòÍ≤å ÎåÄÏ≤òÌïòÏûêÎÉ•.",
                totalD: "ÏÑ∏ÏÉÅÏù¥ ÎÑàÎ•º ÏñµÏïïÌïòÎ†§ ÎìúÎäîÍµ∞. Ïà® Ï£ΩÏù¥Í≥† Í∏∞Îã§Î†§.",
                moneyL: "Ï∂©ÎèôÍµ¨Îß§ Í∏àÏßÄ! Ïò§ÎäòÏùÄ ÏïÑÎÅºÎäî Í≤å Î≤ÑÎäî Í±∞Îã§ÎÉ•.",
                moneyD: "ÎåÄÍ∞Ä ÏóÜÎäî Ïù¥ÎìùÏùÄ ÏóÜÎã§. Ìï®Î∂ÄÎ°ú ÏÜêÎåÄÏßÄ Îßà."
            },
            'Ïù∏ÏÑ±': {
                score: 90,
                totalL: "Í∑ÄÏù∏Ïù¥ ÎèïÎäî ÎÇ†! Í∞ÄÎßåÌûà ÏûàÏñ¥ÎèÑ Îñ°Ïù¥ ÏÉùÍ∏¥Îã§ÎÉ•?",
                totalD: "Ïñ¥Îë†Ïùò Ï°∞Î†•ÏûêÍ∞Ä ÏûàÎã§. Í≥ÑÏïΩÌïòÍ∏∞ Ï¢ãÏùÄ ÎÇ†Ïù¥Ïïº.",
                moneyL: "Î¨∏ÏÑúÏö¥Ïù¥ Ï¢ãÎã§ÎÉ•! Î≥µÍ∂åÏù¥ÎÇò Ï£ºÏãùÎèÑ Í¥úÏ∞ÆÏùÑÏßÄÎèÑ?",
                moneyD: "ÌÅ∞ Í∑∏Î¶ºÏùÑ Í∑∏Î†§Îùº. ÎãπÏû•Ïùò ÌòÑÍ∏àÎ≥¥Îã§ ÎØ∏Îûò Í∞ÄÏπòÏïº."
            }
        };

        const t = TEXT_DB[rel];
        const easyDesc = this.EASY_DESC[myElem][todayElem];
        const finalScore = t.score + timeBonus; 
        
        const cand = this.LUCKY_MAP[myElem];
        const todayCode = new Date().getDate();
        const myCode = myElem.charCodeAt(0);
        const luckyNum = cand[(todayCode + myCode) % cand.length];

        return {
          relation: rel,
          score: Math.min(100, Math.max(0, finalScore)),
          luckyNum: luckyNum,
          light: { total: t.totalL, money: t.moneyL, desc: easyDesc.L },
          dark:  { total: t.totalD, money: t.moneyD, desc: easyDesc.D }
        };
      }
    };
    // ============================================ 

    let currentSets = [];

    function xmur3(str) {
      let h = 1779033703 ^ str.length;
      for (let i = 0; i < str.length; i++) {
        h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
        h = (h << 13) | (h >>> 19);
      }
      return function() {
        h = Math.imul(h ^ (h >>> 16), 2246822507);
        h = Math.imul(h ^ (h >>> 13), 3266489909);
        h ^= h >>> 16;
        return h >>> 0;
      };
    }

    function mulberry32(seed) {
      let a = seed >>> 0;
      return function() {
        a |= 0;
        a = (a + 0x6D2B79F5) | 0;
        let t = Math.imul(a ^ (a >>> 15), 1 | a);
        t = (t + Math.imul(t ^ (t >>> 7), 61 | t)) ^ t;
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }

    function buildSeedString() {
      const name = (inpName.value || "").trim();
      const birth = (inpBirth.value || "").trim();
      const time = (inpTime.value || "").trim();
      const key = (inpKeyword.value || "").trim();
      
      const now = new Date();
      const todayStr = `${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()}`;

      if (!name && !birth && !key) return null;
      return `name=${name}|birth=${birth}|time=${time}|key=${key}|date=${todayStr}`;
    }

    function pickFiveSetsWithSeed(seed, luckyNum = null) {
      const out = [];
      for (let i=0;i<5;i++){
        const rng = mulberry32((seed + i * 0x9E3779B9) >>> 0);
        const set = new Set();
        if (luckyNum) set.add(luckyNum); 
        while (set.size < 6) {
          const n = Math.floor(rng() * 45) + 1;
          set.add(n);
        }
        out.push([...set].sort((a,b)=>a-b));
      }
      return out;
    }

    function pickFiveSetsRandom() {
      const out = [];
      for (let i=0;i<5;i++){
        const rng = () => Math.random();
        out.push(pickOneSetRandom(rng));
      }
      return out;
    }
    
    function pickOneSetRandom(rng) {
        const set = new Set();
        while (set.size < 6) {
          const n = Math.floor(rng() * 45) + 1;
          set.add(n);
        }
        return [...set].sort((a,b)=>a-b);
    }

    function rangeClass(n) {
      if (n <= 10) return "r1";
      if (n <= 20) return "r2";
      if (n <= 30) return "r3";
      if (n <= 40) return "r4";
      return "r5";
    }

    function nowStamp() {
      const d = new Date();
      const pad = (x) => String(x).padStart(2,"0");
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
    }

    function setToast(msg) { toastEl.textContent = msg; }

    function sparkleAt(x, y) {
      for (let i=0;i<10;i++){
        const s = document.createElement("div");
        s.className = "spark";
        const dx = (Math.random()*2-1) * 70;
        const dy = (Math.random()*2-1) * 70;
        s.style.left = x + "px";
        s.style.top  = y + "px";
        s.style.setProperty("--dx", dx + "px");
        s.style.setProperty("--dy", dy + "px");
        document.body.appendChild(s);
        s.addEventListener("animationend", ()=> s.remove());
      }
    }

    async function copyText(text) {
      try { await navigator.clipboard.writeText(text); return true; } 
      catch { return false; }
    }

    function renderSets(sets, luckyNum = null, baseScore = 0) {
      setsEl.innerHTML = "";
      sets.forEach((nums, idx) => {
        const card = document.createElement("div");
        card.className = "set-card";
        card.dataset.idx = idx; 

        const badge = document.createElement("div");
        badge.className = "rank-badge";
        card.appendChild(badge);

        const top = document.createElement("div");
        top.className = "set-top";

        const label = document.createElement("div");
        label.className = "set-label";
        label.innerHTML = `Set ${idx+1} <span class="pill">${nums.join("-")}</span>`;

        const btn = document.createElement("button");
        btn.className = "mini-btn";
        btn.type = "button";
        btn.innerHTML = "üìã";
        btn.addEventListener("click", async (e) => {
          const ok = await copyText(nums.join(", "));
          if (ok) setToast(`Î≥µÏÇ¨ ÏôÑÎ£å ‚úÖ (Set ${idx+1})`);
          else setToast("Î≥µÏÇ¨ Ïã§Ìå®... Í∂åÌïúÏùÑ ÌôïÏù∏Ìï¥.");
          const rect = e.currentTarget.getBoundingClientRect();
          sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);
        });

        top.appendChild(label);
        top.appendChild(btn);

        const balls = document.createElement("div");
        balls.className = "balls";

        // Score Sync Logic: Base Score +/- 5
        // Use set numbers sum to create deterministic variation
        const variation = (nums.reduce((a,b)=>a+b,0) % 11) - 5; // -5 to +5
        const setScore = Math.min(100, Math.max(0, baseScore + variation));
        
        card.dataset.score = setScore;

        nums.forEach((n, j) => {
          const b = document.createElement("div");
          b.className = `ball ${rangeClass(n)}`;
          if (luckyNum && n === luckyNum) b.classList.add("lucky"); 
          b.textContent = n;
          b.style.setProperty("--d", `${(idx*60) + (j*70)}ms`);
          requestAnimationFrame(() => b.classList.add("show"));
          balls.appendChild(b);
        });

        card.appendChild(top);
        card.appendChild(balls);
        setsEl.appendChild(card);
      });
      
      btnSort.textContent = "üèÜ Í∏∞Ïö¥Ïàú Ï†ïÎ†¨ (TOP 5)";
      btnSort.disabled = false;
    }

    function setLoading(on) {
      if (on) btnPick.classList.add("loading");
      else btnPick.classList.remove("loading");
    }

    btnSort.addEventListener("click", () => {
        const cards = Array.from(setsEl.children);
        cards.sort((a, b) => Number(b.dataset.score) - Number(a.dataset.score));
        
        setsEl.innerHTML = "";
        cards.forEach((card, i) => {
            card.classList.remove("rank-1", "rank-2", "rank-3");
            const badge = card.querySelector(".rank-badge");
            badge.style.display = "none"; 
            
            const score = card.dataset.score;

            if (i === 0) {
                card.classList.add("rank-1");
                badge.innerHTML = `üëë TOP 1<span class="rank-score">Ïò§ÌñâÏ†êÏàò: ${score}</span>`;
                badge.style.display = "block";
            }
            if (i === 1) {
                card.classList.add("rank-2");
                badge.innerHTML = `ü•à TOP 2<span class="rank-score">Ïò§ÌñâÏ†êÏàò: ${score}</span>`;
                badge.style.display = "block";
            }
            if (i === 2) {
                card.classList.add("rank-3");
                badge.innerHTML = `ü•â TOP 3<span class="rank-score">Ïò§ÌñâÏ†êÏàò: ${score}</span>`;
                badge.style.display = "block";
            }
            setsEl.appendChild(card);
        });
        
        btnSort.textContent = "‚ú® Ï†ïÎ†¨ ÏôÑÎ£å!";
        btnSort.disabled = true;
    });

    btnPick.addEventListener("click", async (e) => {
      setLoading(true);
      const rect = e.currentTarget.getBoundingClientRect();
      sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);

      await new Promise(r => setTimeout(r, 600));

      const name = inpName.value.trim();
      const birth = inpBirth.value; 
      const time = inpTime.value; 
      const key = inpKeyword.value.trim();
      const seedStr = buildSeedString();
      const t = isDark ? TEXTS.dark : TEXTS.light;
      
      let luckyNum = null;
      let baseScore = 50; // default

      if (name && birth) {
        const [by, bm, bd] = birth.split('-').map(Number);
        const mySaju = SajuEngine.getGanji(by, bm, bd);
        const now = new Date();
        const todaySaju = SajuEngine.getGanji(now.getFullYear(), now.getMonth()+1, now.getDate());
        
        const myTimeElem = SajuEngine.getTimeElement(mySaju.dayGan, time);
        const result = SajuEngine.analyze(mySaju.dayElement, todaySaju.dayElement, myTimeElem);
        luckyNum = result.luckyNum;
        baseScore = result.score;

        const finalSeedStr = `${seedStr}|score=${result.score}`;
        const seedFn = xmur3(finalSeedStr);
        const seed32 = seedFn();
        
        currentSets = pickFiveSetsWithSeed(seed32, luckyNum);

        const info = isDark ? result.dark : result.light;
        reportTotal.textContent = info.total;
        reportMoney.textContent = info.money;
        reportScore.textContent = `${result.score}Ï†ê`;
        
        reportLuckyMsg.innerHTML = `${t.luckyMsgPre} <span class="lucky-ball">${luckyNum}</span> ${t.luckyMsgPost}`;
        
        reportSaju.innerHTML = `
            <span style="color:var(--sub)">ÎÇò:</span> <b>${mySaju.desc}</b><br/>
            <span style="color:var(--sub)">Ïò§Îäò:</span> <b>${todaySaju.desc}</b>
        `;
        sajuEasyDesc.textContent = info.desc; 
        
        reportCard.style.display = "flex";
        sortArea.style.display = "flex"; 

        const timeMsg = time ? " (ÏãúÍ∞Ñ Î∞òÏòÅÎê®)" : "";
        seedInfoEl.innerHTML = `Î∂ÑÏÑù ÏôÑÎ£å: <b>${name}</b>ÎãòÏùò Ïö¥Î™ÖÏ†Å Î≤àÌò∏${timeMsg}`;
        setToast(t.toastPick);

      } else if (seedStr) {
        const seedFn = xmur3(seedStr);
        const seed32 = seedFn();
        currentSets = pickFiveSetsWithSeed(seed32); 
        baseScore = seed32 % 100; // random score

        reportCard.style.display = "none";
        sortArea.style.display = "none";
        seedInfoEl.textContent = isDark ? "Í≥ÑÏïΩ: Î∂àÏôÑÏ†ÑÌïú Ï†ïÎ≥¥..." : "Í∏∞Ïö¥: Ï†ïÎ≥¥Í∞Ä Ï°∞Í∏à Î∂ÄÏ°±ÌïòÎã§ÎÉ•!";
        setToast(t.toastPick);
      } else {
        currentSets = pickFiveSetsRandom();
        baseScore = Math.floor(Math.random()*100);
        
        reportCard.style.display = "none";
        sortArea.style.display = "none";
        seedInfoEl.textContent = isDark ? "Í≥ÑÏïΩ: Î¨¥ÏûëÏúÑ Ïö¥Î™Ö üé≤" : "Í∏∞Ïö¥: ÎûúÎç§Ïù¥Îã§ÎÉ• üé≤";
        setToast(t.toastRand);
      }

      renderSets(currentSets, luckyNum, baseScore);
      stampEl.textContent = `Time: ${nowStamp()}`;
      setLoading(false);
    });

    // ... existing listeners ...
    btnCopyAll.addEventListener("click", async (e) => {
      const t = isDark ? TEXTS.dark : TEXTS.light;
      if (!currentSets.length) { setToast(t.toastInit); return; }
      const text = currentSets.map((s, i) => `ÏÑ∏Ìä∏ ${i+1}: ${s.join(", ")}`).join("\n");
      const ok = await copyText(text);
      if (ok) setToast(t.toastCopy);
      else setToast("Î≥µÏÇ¨ Ïã§Ìå® üòø");
      const rect = e.currentTarget.getBoundingClientRect();
      sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);
    });

    btnReset.addEventListener("click", (e) => {
      const t = isDark ? TEXTS.dark : TEXTS.light;
      currentSets = [];
      setsEl.innerHTML = "";
      stampEl.textContent = "ÎåÄÍ∏∞ Ï§ë";
      seedInfoEl.textContent = t.seedWait;
      reportCard.style.display = "none";
      sortArea.style.display = "none";
      setToast(t.toastReset);
      const rect = e.currentTarget.getBoundingClientRect();
      sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);
    });

    // ============================================
    // üèÜ ÎãπÏ≤®Ïûê Ïù∏Ï¶ù Î≥¥Îìú Í∏∞Îä•
    // ============================================
    console.log("Ïù∏Ï¶ù Î≥¥Îìú Ï¥àÍ∏∞Ìôî ÏãúÏûë...");
    const certModal = document.getElementById("certModal");
    const btnAddCert = document.getElementById("btnAddCert");
    const btnModalClose = document.getElementById("btnModalClose");
    const btnSubmitCert = document.getElementById("btnSubmitCert");
    const btnSkipPayment = document.getElementById("btnSkipPayment");
    const uploadArea = document.getElementById("uploadArea");
    const certImage = document.getElementById("certImage");
    const certComment = document.getElementById("certComment");
    const certRank = document.getElementById("certRank");
    const certRound = document.getElementById("certRound");
    const certCount = document.getElementById("certCount");
    const certPrize = document.getElementById("certPrize");
    const prizeInputGroup = document.getElementById("prizeInputGroup");
    const totalPrizeDisplay = document.getElementById("totalPrizeDisplay");
    const certFeed = document.getElementById("certFeed");
    const paymentOptions = document.getElementById("paymentOptions");
    const paymentTitle = document.getElementById("paymentTitle");
    const paymentMascot = document.getElementById("paymentMascot");
    const paymentCustom = document.getElementById("paymentCustom");

    // ÏÉÅÏÑ∏ Î™®Îã¨ ÏöîÏÜå
    const detailModal = document.getElementById("detailModal");
    const btnDetailClose = document.getElementById("btnDetailClose");
    const detailImage = document.getElementById("detailImage");
    const detailRankBadge = document.getElementById("detailRankBadge");
    const detailCount = document.getElementById("detailCount");
    const detailPrizeAmount = document.getElementById("detailPrizeAmount");
    const detailRound = document.getElementById("detailRound");
    const detailDate = document.getElementById("detailDate");
    const detailComment = document.getElementById("detailComment");
    const detailPayment = document.getElementById("detailPayment");
    const detailPaymentAmount = document.getElementById("detailPaymentAmount");

    // Í≤∞Ï†ú ÌôïÏù∏ Î™®Îã¨ ÏöîÏÜå
    const paymentConfirmModal = document.getElementById("paymentConfirmModal");
    const paymentConfirmTitle = document.getElementById("paymentConfirmTitle");
    const paymentConfirmAmount = document.getElementById("paymentConfirmAmount");
    const btnPaymentCancel = document.getElementById("btnPaymentCancel");
    const btnPaymentProceed = document.getElementById("btnPaymentProceed");

    // Î™ÖÏòàÏùò Ï†ÑÎãπ Ïπ¥Ïö¥Ìä∏ ÏöîÏÜå
    const fameElements = {
      1: document.getElementById("fame1"),
      2: document.getElementById("fame2"),
      3: document.getElementById("fame3"),
      4: document.getElementById("fame4"),
      5: document.getElementById("fame5")
    };

    // ============================================
    // ÌõÑÏõê ÏÑ§Ï†ï - Buy Me a Coffee ÏÇ¨Ïö© (Í∞úÏù∏Ï†ïÎ≥¥ ÎÖ∏Ï∂ú ÏóÜÏùå)
    // ============================================
    const SUPPORT_CONFIG = {
      // Buy Me a Coffee ÎòêÎäî Ko-fi ÎßÅÌÅ¨Î°ú Î≥ÄÍ≤Ω
      // Í∞ÄÏûÖ ÌõÑ Î≥∏Ïù∏ ÎßÅÌÅ¨Î°ú ÏàòÏ†ïÌïòÏÑ∏Ïöî
      buymeacoffee: "https://www.buymeacoffee.com/yaongsin",
      kofi: "https://ko-fi.com/yaongsin",
      // ÏÇ¨Ïö©Ìï† ÌîåÎû´Ìèº ÏÑ†ÌÉù: "buymeacoffee" ÎòêÎäî "kofi"
      platform: "buymeacoffee"
    };

    // Í≥†Ï†ï ÎãπÏ≤®Í∏à (4Îì±, 5Îì±)
    const FIXED_PRIZES = {
      4: 50000,
      5: 5000
    };

    // 1ÌöåÏ∞® ÏãúÏûëÏùº (2002ÎÖÑ 12Ïõî 7Ïùº ÌÜ†ÏöîÏùº)
    const FIRST_DRAW_DATE = new Date(2002, 11, 7);

    // ÌöåÏ∞®Î≥Ñ Ï∂îÏ≤®Ïùº Í≥ÑÏÇ∞
    function getDrawDate(round) {
      const date = new Date(FIRST_DRAW_DATE);
      date.setDate(date.getDate() + (round - 1) * 7);
      return date;
    }

    // ÎÇ†Ïßú Ìè¨Îß∑ (YY.MM.DD)
    function formatDate(date) {
      const yy = String(date.getFullYear()).slice(2);
      const mm = String(date.getMonth() + 1).padStart(2, '0');
      const dd = String(date.getDate()).padStart(2, '0');
      return `${yy}.${mm}.${dd}`;
    }

    // ÏßÅÏ†Ñ ÌöåÏ∞® Í≥ÑÏÇ∞
    function getLatestRound() {
      const now = new Date();
      const diffTime = now - FIRST_DRAW_DATE;
      const diffWeeks = Math.floor(diffTime / (7 * 24 * 60 * 60 * 1000));
      let round = diffWeeks + 1;

      // ÌÜ†ÏöîÏùº 21Ïãú Ïù¥Ï†ÑÏù¥Î©¥ ÏïÑÏßÅ Ï∂îÏ≤® Ï†ÑÏù¥ÎØÄÎ°ú ÏßÅÏ†Ñ ÌöåÏ∞®
      const dayOfWeek = now.getDay();
      const hour = now.getHours();
      if (dayOfWeek === 6 && hour < 21) {
        round = round - 1;
      }

      return round;
    }

    // ÌöåÏ∞®Î≥Ñ ÎãπÏ≤®Í∏à Ï∫êÏãú (ÎèôÌñâÎ≥µÍ∂å APIÏóêÏÑú Í∞ÄÏ†∏Ïò® Îç∞Ïù¥ÌÑ∞)
    const prizeCache = {};

    // Í∏∞Î≥∏ ÎãπÏ≤®Í∏à (API Ïã§Ìå® Ïãú ÏÇ¨Ïö©)
    const DEFAULT_PRIZES = { 1: 2200000000, 2: 55000000, 3: 1500000 };

    // ÎèôÌñâÎ≥µÍ∂å APIÏóêÏÑú ÎãπÏ≤®Í∏à Í∞ÄÏ†∏Ïò§Í∏∞
    async function fetchPrizeData(round) {
      // Ïù¥ÎØ∏ Ï∫êÏãúÏóê ÏûàÏúºÎ©¥ Î∞òÌôò
      if (prizeCache[round]) {
        return prizeCache[round];
      }

      try {
        // CORS ÌîÑÎ°ùÏãú ÏÇ¨Ïö© (Î¨¥Î£å ÌîÑÎ°ùÏãú - Ïã§ÏÑúÎπÑÏä§ÏóêÏÑúÎäî ÏûêÏ≤¥ ÏÑúÎ≤Ñ Í∂åÏû•)
        const proxyUrl = 'https://api.allorigins.win/raw?url=';
        const apiUrl = `https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo=${round}`;

        const response = await fetch(proxyUrl + encodeURIComponent(apiUrl));
        const data = await response.json();

        if (data.returnValue === "success") {
          prizeCache[round] = {
            1: data.firstWinamnt || DEFAULT_PRIZES[1],
            2: data.secondWinamnt || DEFAULT_PRIZES[2],
            3: data.thirdWinamnt || DEFAULT_PRIZES[3]
          };
          console.log(`${round}ÌöåÏ∞® ÎãπÏ≤®Í∏à Î°úÎìú ÏôÑÎ£å`);
          return prizeCache[round];
        }
      } catch (error) {
        console.log(`${round}ÌöåÏ∞® ÎãπÏ≤®Í∏à Î°úÎìú Ïã§Ìå®, Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©`);
      }

      return DEFAULT_PRIZES;
    }

    // ÌöåÏ∞®Î≥Ñ ÎãπÏ≤®Í∏à Ï°∞Ìöå (ÎπÑÎèôÍ∏∞)
    async function getPrizeForRound(round, rank) {
      const data = await fetchPrizeData(round);
      return data[rank] || 0;
    }

    // ÌöåÏ∞® ÎìúÎ°≠Îã§Ïö¥ ÏöîÏÜå
    const roundSelector = document.getElementById("roundSelector");
    const roundSelectorText = document.getElementById("roundSelectorText");
    const roundList = document.getElementById("roundList");

    // ÌöåÏ∞® ÎìúÎ°≠Îã§Ïö¥ Ï¥àÍ∏∞Ìôî
    function initRoundDropdown() {
      const latestRound = getLatestRound();
      roundList.innerHTML = "";

      // ÏµúÍ∑º 100ÌöåÏ∞® ÌëúÏãú
      for (let round = latestRound; round >= Math.max(1, latestRound - 99); round--) {
        const drawDate = getDrawDate(round);
        const dateStr = formatDate(drawDate);

        const item = document.createElement("div");
        item.className = "round-item";
        item.dataset.round = round;
        item.innerHTML = `
          <span class="round-item-main">${round}ÌöåÏ∞®</span>
          <span class="round-item-date">(${dateStr})</span>
        `;
        item.addEventListener("click", async () => await selectRound(round));
        roundList.appendChild(item);
      }
    }

    // ÌöåÏ∞® ÏÑ†ÌÉù
    async function selectRound(round) {
      const drawDate = getDrawDate(round);
      const dateStr = formatDate(drawDate);

      certRound.value = round;
      roundSelectorText.innerHTML = `<b>${round}ÌöåÏ∞®</b> (${dateStr})`;
      roundList.classList.remove("show");
      roundSelector.classList.remove("open");

      // ÏÑ†ÌÉù ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
      document.querySelectorAll(".round-item").forEach(item => {
        item.classList.toggle("selected", parseInt(item.dataset.round) === round);
      });

      // ÎãπÏ≤®Í∏à Î°úÎî© ÌëúÏãú
      totalPrizeDisplay.textContent = "Î°úÎî©Ï§ë...";
      await calculatePrize();
    }

    // ÎìúÎ°≠Îã§Ïö¥ ÌÜ†Í∏Ä
    roundSelector.addEventListener("click", (e) => {
      e.stopPropagation();
      const isOpen = roundList.classList.contains("show");
      if (isOpen) {
        roundList.classList.remove("show");
        roundSelector.classList.remove("open");
      } else {
        roundList.classList.add("show");
        roundSelector.classList.add("open");
      }
    });

    // Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
    document.addEventListener("click", (e) => {
      if (!e.target.closest(".round-dropdown")) {
        roundList.classList.remove("show");
        roundSelector.classList.remove("open");
      }
    });

    // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
    let certifications = JSON.parse(localStorage.getItem("certifications") || "[]");
    let selectedPayment = 10000; // Í∏∞Î≥∏Í∞í 1ÎßåÏõê
    let uploadedImageData = null;
    let pendingCertData = null; // Í≤∞Ï†ú ÎåÄÍ∏∞ Ï§ëÏù∏ Ïù∏Ï¶ù Îç∞Ïù¥ÌÑ∞

    // Í∏àÏï° Ìè¨Îß∑ÌåÖ
    function formatCurrency(num) {
      return '‚Ç©' + num.toLocaleString('ko-KR');
    }

    // Í∏àÏï° ÌååÏã± (ÏΩ§Îßà Ï†úÍ±∞)
    function parseCurrency(str) {
      return parseInt(str.replace(/[^0-9]/g, '')) || 0;
    }

    // ÎãπÏ≤®Í∏à Í≥ÑÏÇ∞ (ÎπÑÎèôÍ∏∞)
    async function calculatePrize() {
      const rank = parseInt(certRank.value);
      const count = parseInt(certCount.value);
      const round = parseInt(certRound.value) || getLatestRound();
      let prizePerTicket = 0;

      if (rank >= 4) {
        prizePerTicket = FIXED_PRIZES[rank];
        prizeInputGroup.style.display = 'none';
      } else {
        // 1~3Îì±ÏùÄ ÌöåÏ∞®Î≥Ñ ÎãπÏ≤®Í∏à ÏûêÎèô Ï°∞Ìöå (APIÏóêÏÑú Í∞ÄÏ†∏Ïò¥)
        prizePerTicket = await getPrizeForRound(round, rank);
        certPrize.value = prizePerTicket.toLocaleString('ko-KR');
        prizeInputGroup.style.display = 'block';
      }

      const totalPrize = prizePerTicket * count;
      totalPrizeDisplay.textContent = formatCurrency(totalPrize);
      return totalPrize;
    }

    // ÎãπÏ≤® Îì±Ïàò/Îß§Ïàò Î≥ÄÍ≤Ω Ïãú ÏûêÎèô Í≥ÑÏÇ∞
    certRank.addEventListener("change", () => calculatePrize());
    certCount.addEventListener("change", () => calculatePrize());
    certPrize.addEventListener("input", (e) => {
      // Ïà´ÏûêÎßå ÏûÖÎ†•ÎêòÎèÑÎ°ù Ìè¨Îß∑ÌåÖ
      let val = e.target.value.replace(/[^0-9]/g, '');
      if (val) {
        e.target.value = parseInt(val).toLocaleString('ko-KR');
      }
      // ÏàòÎèô ÏûÖÎ†• Ïãú Ï¥ùÏï° Ïû¨Í≥ÑÏÇ∞
      const count = parseInt(certCount.value);
      const prizePerTicket = parseCurrency(e.target.value);
      totalPrizeDisplay.textContent = formatCurrency(prizePerTicket * count);
    });

    // Î≥µÎπÑ ÏÑπÏÖò ÌÖåÎßà ÏóÖÎç∞Ïù¥Ìä∏
    function updatePaymentTheme() {
      if (isDark) {
        paymentTitle.textContent = "üê± Î™ΩÎßà ÏïºÏòπÏóêÍ≤å Î≥µÎπÑ ÎìúÎ¶¨Í∏∞";
        paymentMascot.src = "./mascot_happy_dark.png";
      } else {
        paymentTitle.textContent = "üê± ÏïºÏòπÏã†ÏóêÍ≤å Î≥µÎπÑ ÎìúÎ¶¨Í∏∞";
        paymentMascot.src = "./mascot_happy_bright.png";
      }
    }

    // ÌÖåÎßà Î≥ÄÍ≤Ω Ïãú Î≥µÎπÑ ÏÑπÏÖòÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
    const originalUpdateTheme = updateTheme;
    updateTheme = function() {
      originalUpdateTheme();
      updatePaymentTheme();
    };
    updatePaymentTheme(); // Ï¥àÍ∏∞Ìôî

    // Î™ÖÏòàÏùò Ï†ÑÎãπ ÏóÖÎç∞Ïù¥Ìä∏
    function updateHallOfFame() {
      const counts = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };
      certifications.forEach(cert => {
        if (counts[cert.rank] !== undefined) {
          counts[cert.rank] += (cert.count || 1);
        }
      });
      for (let i = 1; i <= 5; i++) {
        fameElements[i].innerHTML = `${counts[i]}<span>Î™Ö</span>`;
      }
    }

    // Ïù∏Ï¶ù ÌîºÎìú Î†åÎçîÎßÅ
    function renderCertFeed() {
      if (certifications.length === 0) {
        certFeed.innerHTML = `
          <div class="cert-empty">
            <div class="cert-empty-icon">üé±</div>
            <p>ÏïÑÏßÅ Ïù∏Ï¶ùÎêú ÎãπÏ≤® ÎÇ¥Ïó≠Ïù¥ ÏóÜÎã§ÎÉ•!<br/>Ï≤´ Î≤àÏß∏ ÌñâÏö¥Ïùò Ï£ºÏù∏Í≥µÏù¥ ÎêòÏñ¥Î≥¥ÎùºÎÉ•~</p>
          </div>
        `;
        return;
      }

      certFeed.innerHTML = "";
      // ÏµúÏã†Ïàú Ï†ïÎ†¨
      const sorted = [...certifications].sort((a, b) => b.timestamp - a.timestamp);

      sorted.forEach(cert => {
        const card = document.createElement("div");
        card.className = "cert-card";
        card.style.cursor = "pointer";

        const rankLabels = {
          1: "ü•á 1Îì± ÎãπÏ≤®",
          2: "ü•à 2Îì± ÎãπÏ≤®",
          3: "ü•â 3Îì± ÎãπÏ≤®",
          4: "üéØ 4Îì± ÎãπÏ≤®",
          5: "üçÄ 5Îì± ÎãπÏ≤®"
        };

        const count = cert.count || 1;
        const countStr = count > 1 ? ` x${count}` : "";

        const dateStr = new Date(cert.timestamp).toLocaleDateString("ko-KR", {
          year: "numeric",
          month: "long",
          day: "numeric"
        });

        // Ï¥ù ÎãπÏ≤®Í∏à
        const totalPrize = cert.totalPrize || 0;
        const prizeHtml = totalPrize > 0
          ? `<div class="cert-prize">üí∞ <span class="cert-prize-amount">${formatCurrency(totalPrize)}</span></div>`
          : "";

        // Î≥µÎπÑ ÌëúÏãú
        const paymentHtml = cert.payment > 0
          ? `<div class="cert-payment">üíù Î≥µÎπÑ ${cert.payment.toLocaleString()}Ïõê</div>`
          : "";

        // ÌöåÏ∞® ÌëúÏãú
        const roundHtml = cert.round
          ? `<span class="cert-meta-tag">${cert.round}Ìöå</span>`
          : "";

        card.innerHTML = `
          <div class="cert-image">
            ${cert.image ? `<img src="${cert.image}" alt="ÎãπÏ≤® Ïù∏Ï¶ù" />` : "üé±"}
          </div>
          <div class="cert-content">
            <span class="cert-rank-badge rank-${cert.rank}">${rankLabels[cert.rank]}${countStr}</span>
            ${prizeHtml}
            <p class="cert-comment">${escapeHtml(cert.comment) || "ÏÜåÍ∞ê ÏóÜÏùå"}</p>
            <div class="cert-meta">
              ${roundHtml}
              <span class="cert-meta-tag">${dateStr}</span>
            </div>
            ${paymentHtml}
          </div>
        `;

        // ÌÅ¥Î¶≠ Ïãú ÏÉÅÏÑ∏ Î≥¥Í∏∞
        card.addEventListener("click", () => openDetailModal(cert));

        certFeed.appendChild(card);
      });
    }

    // ÏÉÅÏÑ∏ Î™®Îã¨ Ïó¥Í∏∞
    function openDetailModal(cert) {
      const rankLabels = {
        1: "ü•á 1Îì± ÎãπÏ≤®",
        2: "ü•à 2Îì± ÎãπÏ≤®",
        3: "ü•â 3Îì± ÎãπÏ≤®",
        4: "üéØ 4Îì± ÎãπÏ≤®",
        5: "üçÄ 5Îì± ÎãπÏ≤®"
      };

      const count = cert.count || 1;
      detailImage.src = cert.image || "";
      detailRankBadge.textContent = rankLabels[cert.rank];
      detailRankBadge.className = `detail-rank-badge rank-${cert.rank}`;
      detailCount.textContent = count > 1 ? `x${count}` : "x1";
      detailCount.style.display = count > 1 ? "inline" : "none";

      const totalPrize = cert.totalPrize || 0;
      detailPrizeAmount.textContent = formatCurrency(totalPrize);

      detailRound.textContent = cert.round ? `${cert.round}Ìöå` : "-";
      detailDate.textContent = new Date(cert.timestamp).toLocaleDateString("ko-KR", {
        year: "numeric",
        month: "long",
        day: "numeric"
      });

      detailComment.textContent = cert.comment || "ÏÜåÍ∞êÏù¥ ÏóÜÏäµÎãàÎã§.";

      if (cert.payment > 0) {
        detailPayment.style.display = "inline-flex";
        detailPaymentAmount.textContent = `Î≥µÎπÑ ${cert.payment.toLocaleString()}Ïõê`;
      } else {
        detailPayment.style.display = "none";
      }

      detailModal.classList.add("show");
      document.body.style.overflow = "hidden";
    }

    // ÏÉÅÏÑ∏ Î™®Îã¨ Îã´Í∏∞
    btnDetailClose.addEventListener("click", () => {
      detailModal.classList.remove("show");
      document.body.style.overflow = "";
    });
    detailModal.addEventListener("click", (e) => {
      if (e.target === detailModal) {
        detailModal.classList.remove("show");
        document.body.style.overflow = "";
      }
    });

    // HTML Ïù¥Ïä§ÏºÄÏù¥ÌîÑ
    function escapeHtml(text) {
      const div = document.createElement("div");
      div.textContent = text;
      return div.innerHTML;
    }

    // Î™®Îã¨ Ïó¥Í∏∞
    btnAddCert.addEventListener("click", async () => {
      certModal.classList.add("show");
      document.body.style.overflow = "hidden";
      updatePaymentTheme();
      await resetModal();
    });

    // Î™®Îã¨ Îã´Í∏∞
    function closeModal() {
      certModal.classList.remove("show");
      document.body.style.overflow = "";
    }

    btnModalClose.addEventListener("click", closeModal);
    certModal.addEventListener("click", (e) => {
      if (e.target === certModal) closeModal();
    });

    // Î™®Îã¨ Ï¥àÍ∏∞Ìôî
    async function resetModal() {
      uploadedImageData = null;
      selectedPayment = 10000;
      certComment.value = "";
      certRank.value = "1";
      certCount.value = "1";
      certPrize.value = "";
      paymentCustom.value = "";

      // ÌöåÏ∞® ÎìúÎ°≠Îã§Ïö¥ Ï¥àÍ∏∞Ìôî
      initRoundDropdown();
      await selectRound(getLatestRound());

      uploadArea.innerHTML = `
        <div class="upload-icon">üì∑</div>
        <div class="upload-text">ÎãπÏ≤® Ï∫°Ï≤ò Ïù¥ÎØ∏ÏßÄÎ•º ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî<br/>(ÌÅ¥Î¶≠ / ÎìúÎûòÍ∑∏ / Ctrl+V Î∂ôÏó¨ÎÑ£Í∏∞)</div>
      `;
      uploadArea.classList.remove("has-image");
      document.querySelectorAll(".payment-option").forEach(opt => {
        if (opt.dataset.amount === "10000") {
          opt.classList.add("selected");
        } else {
          opt.classList.remove("selected");
        }
      });
    }

    // Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú ÏòÅÏó≠ ÌÅ¥Î¶≠
    uploadArea.addEventListener("click", () => {
      certImage.click();
    });

    // ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠
    uploadArea.addEventListener("dragover", (e) => {
      e.preventDefault();
      uploadArea.style.borderColor = "var(--mint2)";
    });
    uploadArea.addEventListener("dragleave", () => {
      uploadArea.style.borderColor = "";
    });
    uploadArea.addEventListener("drop", (e) => {
      e.preventDefault();
      uploadArea.style.borderColor = "";
      const file = e.dataTransfer.files[0];
      if (file && file.type.startsWith("image/")) {
        handleImageUpload(file);
      }
    });

    // ÌÅ¥Î¶ΩÎ≥¥Îìú Î∂ôÏó¨ÎÑ£Í∏∞
    document.addEventListener("paste", (e) => {
      if (!certModal.classList.contains("show")) return;
      const items = e.clipboardData?.items;
      if (!items) return;
      for (let i = 0; i < items.length; i++) {
        if (items[i].type.startsWith("image/")) {
          e.preventDefault();
          const file = items[i].getAsFile();
          if (file) {
            handleImageUpload(file);
            uploadArea.style.borderColor = "var(--btn1)";
            setTimeout(() => { uploadArea.style.borderColor = ""; }, 500);
          }
          break;
        }
      }
    });

    // Ïù¥ÎØ∏ÏßÄ ÌååÏùº ÏÑ†ÌÉù
    certImage.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (file) handleImageUpload(file);
    });

    // Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú Ï≤òÎ¶¨
    function handleImageUpload(file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        uploadedImageData = e.target.result;
        uploadArea.classList.add("has-image");
        uploadArea.innerHTML = `<img src="${uploadedImageData}" alt="ÏóÖÎ°úÎìúÎêú Ïù¥ÎØ∏ÏßÄ" />`;
      };
      reader.readAsDataURL(file);
    }

    // Í≤∞Ï†ú ÏòµÏÖò ÏÑ†ÌÉù
    paymentOptions.addEventListener("click", (e) => {
      const option = e.target.closest(".payment-option");
      if (option) {
        document.querySelectorAll(".payment-option").forEach(opt => opt.classList.remove("selected"));
        option.classList.add("selected");
        selectedPayment = parseInt(option.dataset.amount);
        paymentCustom.value = "";
      }
    });

    // ÏßÅÏ†ë ÏûÖÎ†•
    paymentCustom.addEventListener("input", () => {
      const customValue = parseInt(paymentCustom.value) || 0;
      if (customValue > 0) {
        document.querySelectorAll(".payment-option").forEach(opt => opt.classList.remove("selected"));
        selectedPayment = customValue;
      }
    });

    paymentCustom.addEventListener("focus", () => {
      document.querySelectorAll(".payment-option").forEach(opt => opt.classList.remove("selected"));
    });

    // Î≥µÎπÑ Ïä§ÌÇµ
    if (btnSkipPayment) {
      btnSkipPayment.addEventListener("click", () => {
        console.log("Î≥µÎπÑ Ïä§ÌÇµ ÌÅ¥Î¶≠");
        document.querySelectorAll(".payment-option").forEach(opt => opt.classList.remove("selected"));
        paymentCustom.value = "";
        selectedPayment = 0;
      });
    } else {
      console.error("btnSkipPayment ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§");
    }

    // Ïù∏Ï¶ù Ï†úÏ∂ú Î≤ÑÌäº ÌÅ¥Î¶≠
    if (btnSubmitCert) {
      btnSubmitCert.addEventListener("click", async (e) => {
        e.preventDefault();
        e.stopPropagation();
        console.log("Ïù∏Ï¶ù Í≤åÏãúÌïòÍ∏∞ ÌÅ¥Î¶≠");
        try {
          if (!uploadedImageData) {
            alert("ÎãπÏ≤® Ïù∏Ï¶ù Ïù¥ÎØ∏ÏßÄÎ•º ÏóÖÎ°úÎìúÌï¥Ï£ºÏÑ∏Ïöî!");
            return;
          }

          // ÌöåÏ∞® ÌôïÏù∏
          if (!certRound.value) {
            alert("ÌöåÏ∞®Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!");
            return;
          }

          // ÏßÅÏ†ë ÏûÖÎ†• Í∞í ÌôïÏù∏
          const customValue = parseInt(paymentCustom.value) || 0;
          if (customValue > 0) {
            selectedPayment = customValue;
          }

          const rank = parseInt(certRank.value);
          const count = parseInt(certCount.value);
          let prizePerTicket = 0;

          if (rank >= 4) {
            prizePerTicket = FIXED_PRIZES[rank];
          } else {
            prizePerTicket = parseCurrency(certPrize.value);
          }

          const totalPrize = prizePerTicket * count;

          // Ïù∏Ï¶ù Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ
          pendingCertData = {
            id: Date.now(),
            rank: rank,
            count: count,
            round: certRound.value ? parseInt(certRound.value) : null,
            prizePerTicket: prizePerTicket,
            totalPrize: totalPrize,
            image: uploadedImageData,
            comment: certComment.value.trim(),
            payment: selectedPayment,
            timestamp: Date.now()
          };

          console.log("pendingCertData ÏÉùÏÑ±:", pendingCertData);

          // Î≥µÎπÑÍ∞Ä ÏûàÏúºÎ©¥ Í≤∞Ï†ú ÌôïÏù∏ Î™®Îã¨ ÌëúÏãú
          if (selectedPayment > 0) {
            const mascotName = isDark ? "Î™ΩÎßà ÏïºÏòπ" : "ÏïºÏòπÏã†";
            paymentConfirmTitle.textContent = `${mascotName}ÏóêÍ≤å Î≥µÎπÑ Î≥¥ÎÇ¥Í∏∞`;
            paymentConfirmAmount.textContent = formatCurrency(selectedPayment);
            paymentConfirmModal.classList.add("show");
            console.log("Í≤∞Ï†ú ÌôïÏù∏ Î™®Îã¨ ÌëúÏãú");
          } else {
            // Î≥µÎπÑ ÏóÜÏù¥ Î∞îÎ°ú Ï†ÄÏû•
            console.log("Î≥µÎπÑ ÏóÜÏù¥ Ï†ÄÏû• ÏãúÏûë");
            saveCertification();
          }
        } catch (error) {
          console.error("Ïù∏Ï¶ù Ï†úÏ∂ú Ïò§Î•ò:", error);
          alert("Ïù∏Ï¶ù Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: " + error.message);
        }
      });
    } else {
      console.error("btnSubmitCert ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§");
    }

    // Í≤∞Ï†ú Ï∑®ÏÜå
    if (btnPaymentCancel) {
      btnPaymentCancel.addEventListener("click", () => {
        console.log("Í≤∞Ï†ú Ï∑®ÏÜå ÌÅ¥Î¶≠");
        paymentConfirmModal.classList.remove("show");
        pendingCertData = null;
      });
    }

    // ÌõÑÏõê ÌîåÎû´ÌèºÏúºÎ°ú Ïù¥Îèô (Buy Me a Coffee / Ko-fi)
    if (btnPaymentProceed) {
      btnPaymentProceed.addEventListener("click", (e) => {
        console.log("ÌõÑÏõêÌïòÎü¨ Í∞ÄÍ∏∞ ÌÅ¥Î¶≠");
        e.preventDefault();
        e.stopPropagation();

        try {
          // Ïù∏Ï¶ù Î®ºÏ†Ä Ï†ÄÏû•
          saveCertification();
          paymentConfirmModal.classList.remove("show");

          // ÌõÑÏõê ÌéòÏù¥ÏßÄ Ïó¥Í∏∞
          const supportUrl = SUPPORT_CONFIG[SUPPORT_CONFIG.platform];
          console.log("ÌõÑÏõê URL:", supportUrl);

          // ÌåùÏóÖ Ï∞®Îã® Î∞©ÏßÄÎ•º ÏúÑÌï¥ ÏßÅÏ†ë ÎßÅÌÅ¨Î°úÎèÑ ÏãúÎèÑ
          const newWindow = window.open(supportUrl, "_blank");
          if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
            // ÌåùÏóÖÏù¥ Ï∞®Îã®Îêú Í≤ΩÏö∞ ÏßÅÏ†ë Ïù¥Îèô Ï†úÏïà
            if (confirm("ÌåùÏóÖÏù¥ Ï∞®Îã®ÎêòÏóàÏäµÎãàÎã§. ÌõÑÏõê ÌéòÏù¥ÏßÄÎ°ú ÏßÅÏ†ë Ïù¥ÎèôÌïòÏãúÍ≤†ÏäµÎãàÍπå?")) {
              window.location.href = supportUrl;
            }
          }

          const mascotName = isDark ? "Î™ΩÎßà ÏïºÏòπ" : "ÏïºÏòπÏã†";
          setTimeout(() => {
            setToast(`üíù ${mascotName}ÏóêÍ≤å ÌõÑÏõêÌï¥Ï£ºÏÖîÏÑú Í∞êÏÇ¨ÌïòÎã§ÎÉ•!`);
          }, 500);
        } catch (error) {
          console.error("ÌõÑÏõê Ï≤òÎ¶¨ Ïò§Î•ò:", error);
          alert("Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: " + error.message);
        }
      });
    } else {
      console.error("btnPaymentProceed ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§");
    }

    // Ïù∏Ï¶ù Ï†ÄÏû•
    function saveCertification() {
      console.log("saveCertification Ìò∏Ï∂úÎê®, pendingCertData:", pendingCertData);

      try {
        if (!pendingCertData) {
          console.log("pendingCertDataÍ∞Ä ÏóÜÏùå");
          return;
        }

        certifications.push(pendingCertData);
        localStorage.setItem("certifications", JSON.stringify(certifications));
        console.log("Ïù∏Ï¶ù Ï†ÄÏû• ÏôÑÎ£å, Ï¥ù Í∞úÏàò:", certifications.length);

        updateHallOfFame();
        console.log("Î™ÖÏòàÏùò Ï†ÑÎãπ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å");

        renderCertFeed();
        console.log("ÌîºÎìú Î†åÎçîÎßÅ ÏôÑÎ£å");

        closeModal();
        console.log("Î™®Îã¨ Îã´Í∏∞ ÏôÑÎ£å");

        const mascotName = isDark ? "Î™ΩÎßà ÏïºÏòπ" : "ÏïºÏòπÏã†";
        const paymentMsg = pendingCertData.payment > 0
          ? ` ${mascotName}ÏóêÍ≤å ${pendingCertData.payment.toLocaleString()}ÏõêÏùò Î≥µÎπÑÎèÑ Í∞êÏÇ¨ÌïòÎã§ÎÉ•!`
          : "";
        setToast(`üéâ Ïù∏Ï¶ù ÏôÑÎ£åÎã§ÎÉ•!${paymentMsg}`);

        if (btnAddCert) {
          const rect = btnAddCert.getBoundingClientRect();
          sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);
        }

        pendingCertData = null;
        console.log("Ïù∏Ï¶ù Ï†ÄÏû• ÌîÑÎ°úÏÑ∏Ïä§ ÏôÑÎ£å");
      } catch (error) {
        console.error("saveCertification Ïò§Î•ò:", error);
        alert("Ïù∏Ï¶ù Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: " + error.message);
      }
    }

    // Ï¥àÍ∏∞ Î†åÎçîÎßÅ
    updateHallOfFame();
    renderCertFeed();
    initRoundDropdown(); // ÌöåÏ∞® ÎìúÎ°≠Îã§Ïö¥ Ï¥àÍ∏∞Ìôî

    // ÎîîÎ≤ÑÍπÖÏö© ÏΩòÏÜî Î°úÍ∑∏
    console.log("=== Ïù∏Ï¶ù Î≥¥Îìú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å ===");
    console.log("ÏµúÍ∑º ÌöåÏ∞®:", getLatestRound());
    console.log("btnSubmitCert:", btnSubmitCert ? "OK" : "NOT FOUND");
    console.log("btnSkipPayment:", btnSkipPayment ? "OK" : "NOT FOUND");
    console.log("btnPaymentProceed:", btnPaymentProceed ? "OK" : "NOT FOUND");
    console.log("btnPaymentCancel:", btnPaymentCancel ? "OK" : "NOT FOUND");
    console.log("certModal:", certModal ? "OK" : "NOT FOUND");
    console.log("paymentConfirmModal:", paymentConfirmModal ? "OK" : "NOT FOUND");
    console.log("Ï†ÄÏû•Îêú Ïù∏Ï¶ù Í∞úÏàò:", certifications.length);
  </script>
</body>
</html>