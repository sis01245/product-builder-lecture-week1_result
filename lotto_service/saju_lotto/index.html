<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸ€ ì¶˜ì‹ì´ ë¡œë˜ 5ì„¸íŠ¸ ì¶”ì²œê¸°</title>

  <style>
    :root{
      --bg1:#f6f2e7;
      --bg2:#efe7d6;
      --card:#ffffffcc;
      --stroke:rgba(24, 32, 48, .12);
      --shadow: 0 20px 60px rgba(15, 23, 42, 0.18);
      --text:#142033;
      --sub: rgba(20, 32, 51, .68);

      --mint:#b9ce89;
      --mint2:#5ca95b;
      --butter:#e8c572;
      --pink:#f7a3b0;

      --btn1:#22c55e;
      --btn2:#16a34a;

      --radius: 26px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 15% 20%, rgba(92,169,91,.18), transparent 55%),
        radial-gradient(900px 500px at 85% 30%, rgba(232,197,114,.18), transparent 55%),
        radial-gradient(900px 500px at 50% 95%, rgba(247,163,176,.14), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    .bg-bubbles{
      position:fixed; inset:0;
      pointer-events:none; z-index:0;
      opacity:.55;
    }
    .bubble{
      position:absolute;
      width: 180px; height: 180px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.7), rgba(255,255,255,.15));
      border: 1px solid rgba(255,255,255,.5);
      box-shadow: 0 18px 45px rgba(20,32,51,.08);
      animation: floaty 10s ease-in-out infinite;
    }
    .bubble.b1{ left:-40px; top:18%; width:220px; height:220px; animation-duration: 12s; }
    .bubble.b2{ right:-60px; top:8%; width:260px; height:260px; animation-duration: 14s; }
    .bubble.b3{ left:12%; bottom:-80px; width:240px; height:240px; animation-duration: 16s; }
    .bubble.b4{ right:18%; bottom:-120px; width:300px; height:300px; animation-duration: 18s; }
    @keyframes floaty{
      0%,100%{ transform: translateY(0) translateX(0) scale(1); }
      50%{ transform: translateY(-18px) translateX(12px) scale(1.02); }
    }

    .wrap{
      position:relative;
      z-index:1;
      width:min(1060px, 92vw);
      margin: clamp(18px, 4vw, 36px) auto;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 18px;
    }
    @media (max-width: 940px){
      .wrap{ grid-template-columns: 1fr; }
    }

    .panel{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      overflow:hidden;
      position:relative;
    }
    .panel::before{
      content:"";
      position:absolute;
      inset:-40px;
      background:
        radial-gradient(240px 240px at 20% 20%, rgba(185,206,137,.35), transparent 62%),
        radial-gradient(220px 220px at 80% 10%, rgba(232,197,114,.26), transparent 60%),
        radial-gradient(220px 220px at 85% 85%, rgba(247,163,176,.22), transparent 62%);
      pointer-events:none;
      z-index:0;
    }
    .panel > *{ position:relative; z-index:1; }

    .left{ padding: 22px 22px 18px; }

    .title-row{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    h1{
      margin:0;
      font-size: clamp(20px, 2.2vw, 28px);
      letter-spacing: -0.5px;
      line-height:1.1;
    }
    .subtitle{
      margin:8px 0 0;
      color:var(--sub);
      font-size: 14px;
      line-height:1.4;
    }

    .badge{
      display:flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid rgba(20,32,51,.12);
      background: rgba(255,255,255,.75);
      box-shadow: 0 10px 22px rgba(20,32,51,.08);
      white-space:nowrap;
      user-select:none;
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: linear-gradient(135deg, var(--btn1), var(--btn2));
      box-shadow: 0 0 0 4px rgba(34,197,94,.18);
    }
    .badge span{ font-size: 12px; color: rgba(20,32,51,.75); font-weight:900; }

    /* input area */
    .form{
      margin-top: 14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    @media (max-width: 520px){
      .form{ grid-template-columns: 1fr; }
    }
    .field{
      background: rgba(255,255,255,.58);
      border: 1px solid rgba(20,32,51,.14);
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: 0 10px 22px rgba(20,32,51,.06);
    }
    .field label{
      display:block;
      font-size: 12px;
      color: rgba(20,32,51,.68);
      font-weight: 900;
      margin-bottom: 6px;
      letter-spacing:-0.2px;
    }
    .field input{
      width:100%;
      border:none;
      outline:none;
      background: transparent;
      font-size: 14px;
      color: rgba(20,32,51,.92);
      font-weight: 800;
    }
    .field small{
      display:block;
      margin-top: 6px;
      font-size: 11px;
      color: rgba(20,32,51,.55);
      line-height:1.25;
    }

    .controls{
      margin-top: 12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    button{
      border:none;
      border-radius: 16px;
      padding: 12px 14px;
      cursor:pointer;
      font-weight: 950;
      transition: transform .12s ease, filter .14s ease, opacity .14s ease;
      user-select:none;
      display:flex;
      align-items:center;
      gap:10px;
      letter-spacing:-0.2px;
    }
    button:active{ transform: translateY(1px) scale(.99); }
    button:hover{ filter: brightness(1.02); }

    .btn-main{
      background: linear-gradient(135deg, var(--btn1), var(--btn2));
      color: #062012;
      box-shadow: 0 14px 28px rgba(22,163,74,.22);
      flex: 1;
      min-width: 230px;
      position:relative;
      overflow:hidden;
    }
    .btn-main::after{
      content:"";
      position:absolute;
      inset:-40px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.45), transparent 40%);
      transform: translateX(-20%);
      opacity:.8;
      pointer-events:none;
    }
    .btn-ghost{
      background: rgba(255,255,255,.55);
      border: 1px solid rgba(20,32,51,.14);
      color: rgba(20,32,51,.86);
      box-shadow: 0 10px 22px rgba(20,32,51,.08);
    }
    .btn-icon{
      width: 34px; height: 34px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      background: rgba(255,255,255,.65);
      border:1px solid rgba(20,32,51,.12);
    }

    .meta{
      margin-top: 12px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      color: rgba(20,32,51,.68);
      font-size: 13px;
    }
    .toast{
      margin-top: 12px;
      min-height: 20px;
      font-size: 13px;
      color: rgba(20,32,51,.70);
    }
    .footer-hint{
      margin-top: 10px;
      font-size: 12px;
      color: rgba(20,32,51,.58);
      line-height:1.35;
    }

    /* right side */
    .right{ display:flex; flex-direction:column; }

    .hero{
      padding: 18px 18px 0;
      display:flex;
      align-items:center;
      gap:14px;
    }
    .hero-img{
      width: 108px; height: 108px;
      border-radius: 26px;
      overflow:hidden;
      border: 1px solid rgba(20,32,51,.12);
      box-shadow: 0 16px 30px rgba(20,32,51,.14);
      flex: 0 0 auto;
      background: rgba(255,255,255,.65);
      position:relative;
    }
    .hero-img img{
      width:100%; height:100%;
      object-fit:cover;
      transform: scale(1.08);
      filter: saturate(1.06) contrast(1.03);
    }
    .hero-text{ flex:1; min-width:0; }
    .hero-text .big{
      font-weight: 1000;
      letter-spacing:-0.6px;
      font-size: 16px;
      margin:0 0 6px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .hero-text .small{
      margin:0;
      color: rgba(20,32,51,.64);
      font-size: 13px;
      line-height:1.35;
    }

    .result{
      padding: 14px 18px 18px;
      display:flex;
      flex-direction:column;
      gap: 12px;
    }
    .sets{ display:grid; gap: 10px; }

    .set-card{
      background: rgba(255,255,255,.65);
      border: 1px solid rgba(20,32,51,.12);
      border-radius: 18px;
      padding: 12px 12px 10px;
      box-shadow: 0 10px 22px rgba(20,32,51,.08);
      overflow:hidden;
      position:relative;
    }
    .set-card::before{
      content:"";
      position:absolute;
      inset:-30px;
      background:
        radial-gradient(220px 160px at 10% 10%, rgba(185,206,137,.25), transparent 60%),
        radial-gradient(200px 140px at 80% 20%, rgba(232,197,114,.18), transparent 60%);
      pointer-events:none;
    }
    .set-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      position:relative;
      z-index:1;
    }
    .set-label{
      font-weight: 1000;
      letter-spacing:-0.4px;
      font-size: 13px;
      color: rgba(20,32,51,.82);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .pill{
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(20,32,51,.12);
      background: rgba(255,255,255,.6);
      color: rgba(20,32,51,.70);
      font-weight: 950;
    }
    .mini-btn{
      padding: 8px 10px;
      border-radius: 14px;
      font-size: 12px;
      background: rgba(255,255,255,.7);
      border:1px solid rgba(20,32,51,.12);
      color: rgba(20,32,51,.82);
      box-shadow: 0 8px 14px rgba(20,32,51,.08);
      cursor:pointer;
      font-weight:950;
      display:flex;
      align-items:center;
      gap:8px;
      transition: transform .12s ease, opacity .12s ease;
    }
    .mini-btn:active{ transform: translateY(1px); opacity:.9; }

    .balls{
      margin-top: 10px;
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
      position:relative;
      z-index:1;
      min-height: 48px;
    }

    .ball{
      width: 44px; height: 44px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      font-weight: 1000;
      letter-spacing:-0.3px;
      color: rgba(11, 18, 32, .92);
      box-shadow:
        inset 0 0 0 2px rgba(255,255,255,.22),
        0 10px 18px rgba(15,23,42,.18);
      user-select:none;
      opacity: 0;
      transform: translateY(10px) scale(.92);
      will-change: transform, opacity, filter;
    }

    .ball.show{
      animation: pop .52s cubic-bezier(.2,.9,.2,1) both;
      animation-delay: var(--d, 0ms);
    }
    @keyframes pop{
      from { transform: translateY(10px) scale(.92); opacity: 0; filter: blur(2px); }
      to   { transform: translateY(0) scale(1); opacity: 1; filter: blur(0); }
    }

    .r1{ background: linear-gradient(135deg, #fbbf24, var(--butter)); }
    .r2{ background: linear-gradient(135deg, #93c5fd, #60a5fa); }
    .r3{ background: linear-gradient(135deg, #fda4af, var(--pink)); }
    .r4{ background: linear-gradient(135deg, #86efac, #34d399); }
    .r5{ background: linear-gradient(135deg, #c4b5fd, #a78bfa); }

    .spark{
      position:absolute;
      width:10px; height:10px;
      border-radius:999px;
      background: rgba(255,255,255,.9);
      pointer-events:none;
      box-shadow: 0 0 0 10px rgba(34,197,94,.12);
      animation: spark .6s ease-out forwards;
      z-index:9999;
    }
    @keyframes spark{
      from{ transform: translate(0,0) scale(.9); opacity: .9; }
      to  { transform: translate(var(--dx), var(--dy)) scale(0); opacity: 0; }
    }

    .loading{ pointer-events:none; opacity:.92; filter:saturate(1.05); }
    .loading .btn-icon{ animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }

    @media (prefers-reduced-motion: reduce) {
      .bubble{ animation:none; }
      .ball.show{ animation:none; opacity:1; transform:none; filter:none; }
      button{ transition:none; }
      .loading .btn-icon{ animation:none; }
    }
  </style>
</head>

<body>
  <div class="bg-bubbles" aria-hidden="true">
    <div class="bubble b1"></div>
    <div class="bubble b2"></div>
    <div class="bubble b3"></div>
    <div class="bubble b4"></div>
  </div>

  <main class="wrap">
    <!-- LEFT -->
    <section class="panel left">
      <div class="title-row">
        <div>
          <h1>ğŸ€ ì¶˜ì‹ì´ ë¡œë˜ ì¶”ì²œ (5ì„¸íŠ¸)</h1>
          <p class="subtitle">
            ê°„ë‹¨ ì •ë³´ ë„£ìœ¼ë©´ ê·¸ ê¸°ìš´(?)ìœ¼ë¡œ <b>5ì„¸íŠ¸</b> ë½‘ì•„ì¤€ë‹¤ëƒ¥ ğŸ¾<br/>
            ê°™ì€ ì •ë³´ë©´ ê°™ì€ ë²ˆí˜¸ê°€ ë‚˜ì™€ì„œ â€œì˜¤ëŠ˜ì˜ ì‚¬ì£¼â€ ëŠë‚Œ ë‚œë‹¤ëƒ¥!
          </p>
        </div>
        <div class="badge" title="ì¬ë¯¸ë¡œë§Œ ë´ë¼ëƒ¥">
          <span class="dot"></span>
          <span>ì¬ë¯¸ìš©ì´ëƒ¥</span>
        </div>
      </div>

      <!-- ì‚¬ì£¼ ëŠë‚Œ ì…ë ¥ -->
      <div class="form">
        <div class="field">
          <label for="inpName">ì´ë¦„</label>
          <input id="inpName" type="text" placeholder="ì˜ˆ) ì¶˜ì‹" autocomplete="name"/>
          <small>ë¹„ì›Œë„ ëœë‹¤ëƒ¥(ê·¸ë• ì™„ì „ ëœë¤ì´ëƒ¥)</small>
        </div>

        <div class="field">
          <label for="inpBirth">ìƒë…„ì›”ì¼</label>
          <input id="inpBirth" type="date" />
          <small>ë‚ ì§œ ë„£ìœ¼ë©´ â€œì˜¤ëŠ˜ì˜ ê¸°ìš´â€ ê³ ì •ëœë‹¤ëƒ¥</small>
        </div>

        <div class="field" style="grid-column: 1 / -1;">
          <label for="inpKeyword">ì˜¤ëŠ˜ì˜ í•œ ì¤„(ì„ íƒ)</label>
          <input id="inpKeyword" type="text" placeholder="ì˜ˆ) ê¸°ë¶„ ì¢‹ìŒ / í”¼ê³¤í•¨ / ëˆë³µì‚¬ ê°€ì¦ˆì•„" />
          <small>í•œ ì¤„ ë„£ìœ¼ë©´ ê¸°ìš´ì´ ì¡°ê¸ˆ ë°”ë€ë‹¤ëƒ¥(=ì‹œë“œì— ì„ëŠ”ë‹¤ëƒ¥)</small>
        </div>
      </div>

      <div class="controls">
        <button class="btn-main" id="btnPick">
          <span class="btn-icon">ğŸ²</span>
          <span>ì‚¬ì£¼ ê¸°ìš´ìœ¼ë¡œ 5ì„¸íŠ¸ ë½‘ê¸°</span>
        </button>

        <button class="btn-ghost" id="btnCopyAll" title="5ì„¸íŠ¸ ì „ì²´ ë³µì‚¬">
          <span class="btn-icon">ğŸ“‹</span>
          <span>ì „ì²´ ë³µì‚¬</span>
        </button>

        <button class="btn-ghost" id="btnReset" title="ì´ˆê¸°í™”">
          <span class="btn-icon">ğŸ§¼</span>
          <span>ì´ˆê¸°í™”</span>
        </button>
      </div>

      <div class="meta">
        <div id="seedInfo">ê¸°ìš´: ëŒ€ê¸°ì¤‘ì´ëƒ¥</div>
        <div id="stamp">ëŒ€ê¸° ì¤‘</div>
      </div>

      <div class="toast" id="toast">
        ì•„ì§ ë½‘ì€ ë²ˆí˜¸ê°€ ì—†ë‹¤ëƒ¥. ë²„íŠ¼ ëˆŒëŸ¬ë³´ë¼ëƒ¥!
      </div>

    </section>

    <!-- RIGHT -->
    <section class="panel right">
      <div class="hero">
        <div class="hero-img" title="mascot.pngë¥¼ ê°™ì€ í´ë”ì— ë‘ë©´ ì—¬ê¸° ëœ¬ë‹¤ëƒ¥!">
          <img id="mascot" alt="ìºë¦­í„°" src="./mascot.png" />
        </div>
        <div class="hero-text">
          <p class="big">ì¶˜ì‹ì´ê°€ ë½‘ì•„ì¤€ 5ì„¸íŠ¸ë‹¤ëƒ¥ ğŸ</p>
          <p class="small">ì„¸íŠ¸ë³„ <b>ë³µì‚¬</b>ë„ ë˜ê³ , <b>ì „ì²´ ë³µì‚¬</b>ë„ ëœë‹¤ëƒ¥!</p>
        </div>
      </div>

      <div class="result">
        <div class="sets" id="sets"></div>
      </div>
    </section>
  </main>

  <script>
    const setsEl  = document.getElementById("sets");
    const stampEl = document.getElementById("stamp");
    const toastEl = document.getElementById("toast");
    const seedInfoEl = document.getElementById("seedInfo");

    const btnPick    = document.getElementById("btnPick");
    const btnCopyAll = document.getElementById("btnCopyAll");
    const btnReset   = document.getElementById("btnReset");

    const inpName    = document.getElementById("inpName");
    const inpBirth   = document.getElementById("inpBirth");
    const inpKeyword = document.getElementById("inpKeyword");

    const mascotImg  = document.getElementById("mascot");

    // âœ… ì´ë¯¸ì§€ ê¹¨ì§ˆ ë•Œ í´ë°±(ì‘ì€ SVG data-uri)ë¡œ ìë™ êµì²´ â†’ "ë„ë°°" ë°©ì§€
    function setMascotFallback() {
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="180" height="180" viewBox="0 0 180 180">
          <defs>
            <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#fff7e6"/>
              <stop offset="1" stop-color="#f2ead7"/>
            </linearGradient>
            <linearGradient id="mint" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#b9ce89"/>
              <stop offset="1" stop-color="#5ca95b"/>
            </linearGradient>
          </defs>
          <rect width="180" height="180" rx="34" fill="url(#bg)"/>
          <path d="M62 58 L72 36 L90 54 L108 36 L118 58 L118 80 Q90 96 62 80 Z"
                fill="url(#mint)" stroke="#3f7c43" stroke-opacity=".35" stroke-width="3" />
          <circle cx="72" cy="36" r="6" fill="#f5d76e"/>
          <circle cx="108" cy="36" r="6" fill="#f5d76e"/>
          <circle cx="90" cy="54" r="6" fill="#f5d76e"/>
          <ellipse cx="90" cy="112" rx="62" ry="52" fill="#f2b37b" fill-opacity=".95"/>
          <circle cx="70" cy="105" r="8" fill="#1c2a3a"/>
          <circle cx="110" cy="105" r="8" fill="#1c2a3a"/>
          <ellipse cx="90" cy="120" rx="18" ry="14" fill="#fff"/>
          <ellipse cx="58" cy="120" rx="14" ry="12" fill="#f7a3b0" fill-opacity=".75"/>
          <ellipse cx="122" cy="120" rx="14" ry="12" fill="#f7a3b0" fill-opacity=".75"/>
        </svg>`;
      mascotImg.src = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg.trim());
    }
    mascotImg.addEventListener("error", setMascotFallback);

    let currentSets = []; // [[n..6], ...]

    // --------------------------
    // âœ… "ì‚¬ì£¼ ëŠë‚Œ" ì‹œë“œ ëœë¤
    // - ê°™ì€ ì…ë ¥ â†’ ê°™ì€ ì‹œë“œ â†’ ê°™ì€ ê²°ê³¼
    // - xmur3 + mulberry32 ì¡°í•©
    // --------------------------
    function xmur3(str) {
      let h = 1779033703 ^ str.length;
      for (let i = 0; i < str.length; i++) {
        h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
        h = (h << 13) | (h >>> 19);
      }
      return function() {
        h = Math.imul(h ^ (h >>> 16), 2246822507);
        h = Math.imul(h ^ (h >>> 13), 3266489909);
        h ^= h >>> 16;
        return h >>> 0;
      };
    }

    function mulberry32(seed) {
      let a = seed >>> 0;
      return function() {
        a |= 0;
        a = (a + 0x6D2B79F5) | 0;
        let t = Math.imul(a ^ (a >>> 15), 1 | a);
        t = (t + Math.imul(t ^ (t >>> 7), 61 | t)) ^ t;
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }

    function buildSeedString() {
      const name = (inpName.value || "").trim();
      const birth = (inpBirth.value || "").trim(); // YYYY-MM-DD
      const key = (inpKeyword.value || "").trim();

      // ì…ë ¥ì´ ì „ë¶€ ë¹„ì–´ ìˆìœ¼ë©´ "ì™„ì „ ëœë¤" ëª¨ë“œë¡œ ì²˜ë¦¬
      if (!name && !birth && !key) return null;

      // ì‚¬ì£¼ ëŠë‚Œì´ë‹ˆê¹Œ "ì˜¤ëŠ˜ ë‚ ì§œ"ëŠ” ì¼ë¶€ëŸ¬ ì•ˆ ì„ìŒ (ê³ ì •ë˜ê²Œ)
      // ëŒ€ì‹  í‚¤ì›Œë“œë¡œ ë³€ì£¼ ê°€ëŠ¥
      return `name=${name}|birth=${birth}|key=${key}`;
    }

    function pickOneSet(rng) {
      const set = new Set();
      while (set.size < 6) {
        const n = Math.floor(rng() * 45) + 1; // 1~45
        set.add(n);
      }
      return [...set].sort((a,b)=>a-b);
    }

    function pickFiveSetsWithSeed(seed) {
      // ì„¸íŠ¸ë³„ë¡œ ì‚´ì§ ë‹¤ë¥¸ ë‚œìˆ˜ íë¦„ì„ ì£¼ê¸° ìœ„í•´ seedë¥¼ ë³€í˜•
      const out = [];
      for (let i=0;i<5;i++){
        const rng = mulberry32((seed + i * 0x9E3779B9) >>> 0);
        out.push(pickOneSet(rng));
      }
      return out;
    }

    function pickFiveSetsRandom() {
      // ì…ë ¥ì´ ì—†ì„ ë• ê¸°ì¡´ì²˜ëŸ¼ ì™„ì „ ëœë¤
      const out = [];
      for (let i=0;i<5;i++){
        const rng = () => Math.random();
        out.push(pickOneSet(rng));
      }
      return out;
    }

    function rangeClass(n) {
      if (n <= 10) return "r1";
      if (n <= 20) return "r2";
      if (n <= 30) return "r3";
      if (n <= 40) return "r4";
      return "r5";
    }

    function nowStamp() {
      const d = new Date();
      const pad = (x) => String(x).padStart(2,"0");
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
    }

    function setToast(msg) { toastEl.textContent = msg; }

    function sparkleAt(x, y) {
      for (let i=0;i<10;i++){
        const s = document.createElement("div");
        s.className = "spark";
        const dx = (Math.random()*2-1) * 70;
        const dy = (Math.random()*2-1) * 70;
        s.style.left = x + "px";
        s.style.top  = y + "px";
        s.style.setProperty("--dx", dx + "px");
        s.style.setProperty("--dy", dy + "px");
        document.body.appendChild(s);
        s.addEventListener("animationend", ()=> s.remove());
      }
    }

    async function copyText(text) {
      try { await navigator.clipboard.writeText(text); return true; }
      catch { return false; }
    }

    function renderSets(sets) {
      setsEl.innerHTML = "";
      sets.forEach((nums, idx) => {
        const card = document.createElement("div");
        card.className = "set-card";

        const top = document.createElement("div");
        top.className = "set-top";

        const label = document.createElement("div");
        label.className = "set-label";
        label.innerHTML = `ì„¸íŠ¸ ${idx+1} <span class="pill">${nums.join("-")}</span>`;

        const btn = document.createElement("button");
        btn.className = "mini-btn";
        btn.type = "button";
        btn.innerHTML = "ğŸ“‹ ë³µì‚¬";
        btn.addEventListener("click", async (e) => {
          const ok = await copyText(nums.join(", "));
          if (ok) setToast(`ë³µì‚¬ ì™„ë£Œë‹¤ëƒ¥ âœ… (ì„¸íŠ¸ ${idx+1})`);
          else setToast("ë³µì‚¬ê°€ ì•ˆ ëœë‹¤ëƒ¥â€¦ ë¸Œë¼ìš°ì € ê¶Œí•œ í™•ì¸í•´ë‹¬ë¼ëƒ¥ ğŸ˜¿");
          const rect = e.currentTarget.getBoundingClientRect();
          sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);
        });

        top.appendChild(label);
        top.appendChild(btn);

        const balls = document.createElement("div");
        balls.className = "balls";

        nums.forEach((n, j) => {
          const b = document.createElement("div");
          b.className = `ball ${rangeClass(n)}`;
          b.textContent = n;
          b.style.setProperty("--d", `${(idx*60) + (j*70)}ms`);
          requestAnimationFrame(() => b.classList.add("show"));
          balls.appendChild(b);
        });

        card.appendChild(top);
        card.appendChild(balls);
        setsEl.appendChild(card);
      });
    }

    function setLoading(on) {
      if (on) btnPick.classList.add("loading");
      else btnPick.classList.remove("loading");
    }

    function luckCommentFromSeed(seed32) {
      // seedë¡œ 0~99 ì ìˆ˜ ë§Œë“¤ì–´ì„œ ë©˜íŠ¸
      const score = seed32 % 100;
      if (score >= 85) return `ê¸°ìš´ ì•„ì£¼ ì„ë‹¤ëƒ¥(${score}ì ) ğŸ€`;
      if (score >= 65) return `ê¸°ìš´ ê´œì°®ë‹¤ëƒ¥(${score}ì ) ğŸ™‚`;
      if (score >= 40) return `ë¬´ë‚œë¬´ë‚œì´ë‹¤ëƒ¥(${score}ì ) ğŸ˜¼`;
      return `ì˜¤ëŠ˜ì€ ì¹¨ì°©í•˜ê²Œ ê°€ìëƒ¥(${score}ì ) ğŸ« `;
    }

    btnPick.addEventListener("click", async (e) => {
      setLoading(true);
      const rect = e.currentTarget.getBoundingClientRect();
      sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);

      await new Promise(r => setTimeout(r, 260));

      const seedStr = buildSeedString();

      if (seedStr) {
        const seedFn = xmur3(seedStr);
        const seed32 = seedFn(); // 32-bit
        currentSets = pickFiveSetsWithSeed(seed32);
        seedInfoEl.textContent = `ê¸°ìš´: ${luckCommentFromSeed(seed32)} (ì…ë ¥ ê¸°ë°˜)`;
        setToast("ì…ë ¥í•œ ê¸°ìš´ìœ¼ë¡œ 5ì„¸íŠ¸ ë½‘ì•„ì¤¬ë‹¤ëƒ¥ ğŸ¾");
      } else {
        currentSets = pickFiveSetsRandom();
        seedInfoEl.textContent = `ê¸°ìš´: ëœë¤ì´ë‹¤ëƒ¥(ì…ë ¥ ì—†ìŒ) ğŸ²`;
        setToast("ì •ë³´ê°€ ì—†ì–´ì„œ ì™„ì „ ëœë¤ìœ¼ë¡œ ë½‘ì•˜ë‹¤ëƒ¥ ğŸ²");
      }

      renderSets(currentSets);
      stampEl.textContent = `ë½‘ì€ ì‹œê°„: ${nowStamp()}`;
      setLoading(false);
    });

    btnCopyAll.addEventListener("click", async (e) => {
      if (!currentSets.length) { setToast("ì•„ì§ ë½‘ì€ ê²Œ ì—†ë‹¤ëƒ¥. ë¨¼ì € ë½‘ì•„ë¼ëƒ¥!"); return; }
      const text = currentSets.map((s, i) => `ì„¸íŠ¸ ${i+1}: ${s.join(", ")}`).join("\n");
      const ok = await copyText(text);
      if (ok) setToast("ì „ì²´ ë³µì‚¬ ì™„ë£Œë‹¤ëƒ¥ âœ…");
      else setToast("ë³µì‚¬ê°€ ì•ˆ ëœë‹¤ëƒ¥â€¦ ë¸Œë¼ìš°ì € ê¶Œí•œ í™•ì¸í•´ë‹¬ë¼ëƒ¥ ğŸ˜¿");
      const rect = e.currentTarget.getBoundingClientRect();
      sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);
    });

    btnReset.addEventListener("click", (e) => {
      currentSets = [];
      setsEl.innerHTML = "";
      stampEl.textContent = "ëŒ€ê¸° ì¤‘";
      seedInfoEl.textContent = "ê¸°ìš´: ëŒ€ê¸°ì¤‘ì´ëƒ¥";
      setToast("ì´ˆê¸°í™”í–ˆë‹¤ëƒ¥. ë‹¤ì‹œ ë½‘ì•„ë³´ë¼ëƒ¥ ğŸ²");
      const rect = e.currentTarget.getBoundingClientRect();
      sparkleAt(rect.left + rect.width/2, rect.top + rect.height/2);
    });
  </script>
</body>
</html>
